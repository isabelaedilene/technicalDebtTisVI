file path,line #,comment,satd
mitmproxy/setup.py,7,Based on https://github.com/pypa/sampleproject/blob/master/setup.py,not
mitmproxy/setup.py,8,and https://python-packaging-user-guide.readthedocs.org/,not
mitmproxy/setup.py,62,https://packaging.python.org/en/latest/requirements/#install-requires,not
mitmproxy/setup.py,63,It is not considered best practice to use install_requires to pin dependencies to specific versions.,not
mitmproxy/setup.py,67,no semver here - this should always be on the last release!,not
mitmproxy/test/filename_matching.py,1,!/usr/bin/env python3,not
mitmproxy/test/filename_matching.py,51,TODO: enable this in the future,SATD
mitmproxy/test/filename_matching.py,52,exitcode += 1,not
mitmproxy/test/full_coverage_plugin.py,90,make sure we get the EXIT_TESTSFAILED exit code,not
mitmproxy/test/individual_coverage.py,1,!/usr/bin/env python3,not
mitmproxy/test/individual_coverage.py,52,"run pytest in a new process, otherwise imports and modules might conflict",not
mitmproxy/test/helper_tools/dumperview.py,1,!/usr/bin/env python,not
mitmproxy/test/helper_tools/memoryleak.py,5,import os,not
mitmproxy/test/helper_tools/memoryleak.py,6,"os.environ[""TK_LIBRARY""] = r""C:\Python27\tcl\tcl8.5""",not
mitmproxy/test/helper_tools/memoryleak.py,7,"os.environ[""TCL_LIBRARY""] = r""C:\Python27\tcl\tcl8.5""",not
mitmproxy/test/helper_tools/memoryleak.py,9,"Also noteworthy: guppy, objgraph",not
mitmproxy/test/helper_tools/memoryleak.py,36,do this to unpollute view,not
mitmproxy/test/helper_tools/memoryleak.py,38,"print(""\r\n"".join(str(x)[:100] for x in gc.get_referrers(ssl)))",not
mitmproxy/test/helper_tools/inspect_dumpfile.py,9,"tnetstring throw a ValueError on EOF, which is hard to catch",not
mitmproxy/test/helper_tools/inspect_dumpfile.py,10,because they raise ValueErrors for a couple of other reasons.,not
mitmproxy/test/helper_tools/inspect_dumpfile.py,11,Check for EOF to avoid this.,not
mitmproxy/test/pathod/test_pathoc.py,167,This should read a frame and close the websocket reader,not
mitmproxy/test/pathod/test_pathod.py,37,"FIXME: Add float values to spec language, reduce test timeout to",SATD
mitmproxy/test/pathod/test_pathod.py,38,increase test performance,not
mitmproxy/test/pathod/test_pathod.py,39,This is a bodge - we have some platform difference that causes,not
mitmproxy/test/pathod/test_pathod.py,40,different exceptions to be raised here.,not
mitmproxy/test/pathod/test_pathod.py,119,FIXME: Other binary data elements,SATD
mitmproxy/test/pathod/test_pathod.py,213,FIXME: Race Condition?,SATD
mitmproxy/test/pathod/protocols/test_websockets.py,1,TODO: write tests,SATD
mitmproxy/test/pathod/protocols/test_http2.py,102,send magic,not
mitmproxy/test/pathod/protocols/test_http2.py,106,send empty settings frame,not
mitmproxy/test/pathod/protocols/test_http2.py,110,check empty settings frame,not
mitmproxy/test/pathod/protocols/test_http2.py,114,check settings acknowledgement,not
mitmproxy/test/pathod/protocols/test_http2.py,118,send settings acknowledgement,not
mitmproxy/test/pathod/protocols/test_http2.py,139,check magic,not
mitmproxy/test/pathod/protocols/test_http2.py,142,check empty settings frame,not
mitmproxy/test/pathod/protocols/test_http2.py,146,send empty settings frame,not
mitmproxy/test/pathod/protocols/test_http2.py,150,check settings acknowledgement,not
mitmproxy/test/pathod/protocols/test_http2.py,154,send settings acknowledgement,not
mitmproxy/test/pathod/protocols/test_http2.py,199,check settings acknowledgement,not
mitmproxy/test/pathod/protocols/test_http2.py,203,just to keep the connection alive a bit longer,not
mitmproxy/test/pathod/protocols/test_http2.py,298,just to keep the connection alive a bit longer,not
mitmproxy/test/pathod/protocols/test_http2.py,374,just to keep the connection alive a bit longer,not
mitmproxy/test/pathod/protocols/test_http.py,1,TODO: write tests,SATD
mitmproxy/test/pathod/language/test_message.py,1,TODO: write tests,SATD
mitmproxy/test/pathod/language/test_websockets.py,100,Simple server frame,not
mitmproxy/test/pathod/language/test_websockets.py,105,Simple client frame,not
mitmproxy/test/pathod/language/test_websockets.py,113,"Server frame, mask explicitly set",not
mitmproxy/test/pathod/language/test_websockets.py,121,"Client frame, mask explicitly unset",not
mitmproxy/test/pathod/language/test_base.py,61,"While pyparsing has a escChar argument for QuotedString,",not
mitmproxy/test/pathod/language/test_base.py,62,"escChar only performs scapes single-character escapes and does not work for e.g. r""\x02"".",not
mitmproxy/test/pathod/language/test_base.py,63,"Thus, we cannot use that option, which means we cannot have single quotes in strings.",not
mitmproxy/test/pathod/language/test_base.py,64,"To fix this, we represent single quotes as r""\x07"".",SATD
mitmproxy/test/pathod/language/test_base.py,80,"self.roundtrip(""\\"")",not
mitmproxy/test/pathod/language/test_http.py,249,"While larger values are known to work on linux, len() technically",not
mitmproxy/test/pathod/language/test_http.py,250,returns an int and a python 2.7 int on windows has 32bit precision.,not
mitmproxy/test/pathod/language/test_http.py,251,"Therefore, we should keep the body length < 2147483647 bytes in our",not
mitmproxy/test/pathod/language/test_http.py,252,tests.,not
mitmproxy/test/pathod/language/test_exceptions.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/test_options.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/test_addonmanager.py,101,calling this again with the same signature is a no-op.,not
mitmproxy/test/mitmproxy/test_addonmanager.py,105,a different signature should emit a warning though.,not
mitmproxy/test/mitmproxy/test_master.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/test_connections.py,139,use this protocol just to assemble - not for actual sending,not
mitmproxy/test/mitmproxy/test_connections.py,202,we need to wait for the test to finish successfully before calling .close() on Windows.,not
mitmproxy/test/mitmproxy/test_connections.py,203,The workaround here is to signal completion by sending data the other way around.,SATD
mitmproxy/test/mitmproxy/tservers.py,130,Test Configuration,not
mitmproxy/test/mitmproxy/tservers.py,152,perf: we want to run tests in parallel,not
mitmproxy/test/mitmproxy/tservers.py,153,"should this ever cause an error, travis should catch it.",not
mitmproxy/test/mitmproxy/tservers.py,154,shutil.rmtree(cls.confdir),not
mitmproxy/test/mitmproxy/tservers.py,163,FIXME: Track down the Windows sync issues,SATD
mitmproxy/test/mitmproxy/tservers.py,355,We need to initialize the chain first so that the normal server gets a correct config.,not
mitmproxy/test/mitmproxy/tservers.py,382,First proxy is in normal mode.,not
mitmproxy/test/mitmproxy/test_ctx.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/test_certs.py,5,class TestDNTree:,not
mitmproxy/test/mitmproxy/test_certs.py,6,def test_simple(self):,not
mitmproxy/test/mitmproxy/test_certs.py,7,d = certs.DNTree(),not
mitmproxy/test/mitmproxy/test_certs.py,8,"d.add(""foo.com"", ""foo"")",not
mitmproxy/test/mitmproxy/test_certs.py,9,"d.add(""bar.com"", ""bar"")",not
mitmproxy/test/mitmproxy/test_certs.py,10,"assert d.get(""foo.com"") == ""foo""",not
mitmproxy/test/mitmproxy/test_certs.py,11,"assert d.get(""bar.com"") == ""bar""",not
mitmproxy/test/mitmproxy/test_certs.py,12,"assert not d.get(""oink.com"")",not
mitmproxy/test/mitmproxy/test_certs.py,13,"assert not d.get(""oink"")",not
mitmproxy/test/mitmproxy/test_certs.py,14,"assert not d.get("""")",not
mitmproxy/test/mitmproxy/test_certs.py,15,"assert not d.get(""oink.oink"")",not
mitmproxy/test/mitmproxy/test_certs.py,16,,not
mitmproxy/test/mitmproxy/test_certs.py,17,"d.add(""*.match.org"", ""match"")",not
mitmproxy/test/mitmproxy/test_certs.py,18,"assert not d.get(""match.org"")",not
mitmproxy/test/mitmproxy/test_certs.py,19,"assert d.get(""foo.match.org"") == ""match""",not
mitmproxy/test/mitmproxy/test_certs.py,20,"assert d.get(""foo.foo.match.org"") == ""match""",not
mitmproxy/test/mitmproxy/test_certs.py,21,,not
mitmproxy/test/mitmproxy/test_certs.py,22,def test_wildcard(self):,not
mitmproxy/test/mitmproxy/test_certs.py,23,d = certs.DNTree(),not
mitmproxy/test/mitmproxy/test_certs.py,24,"d.add(""foo.com"", ""foo"")",not
mitmproxy/test/mitmproxy/test_certs.py,25,"assert not d.get(""*.foo.com"")",not
mitmproxy/test/mitmproxy/test_certs.py,26,"d.add(""*.foo.com"", ""wild"")",not
mitmproxy/test/mitmproxy/test_certs.py,27,,not
mitmproxy/test/mitmproxy/test_certs.py,28,d = certs.DNTree(),not
mitmproxy/test/mitmproxy/test_certs.py,29,"d.add(""*"", ""foo"")",not
mitmproxy/test/mitmproxy/test_certs.py,30,"assert d.get(""foo.com"") == ""foo""",not
mitmproxy/test/mitmproxy/test_certs.py,31,"assert d.get(""*.foo.com"") == ""foo""",not
mitmproxy/test/mitmproxy/test_certs.py,32,"assert d.get(""com"") == ""foo""",not
mitmproxy/test/mitmproxy/test_certs.py,63,assert c1 == c2,not
mitmproxy/test/mitmproxy/test_certs.py,120,TODO: How do we actually attempt to read that file as another user?,SATD
mitmproxy/test/mitmproxy/test_certs.py,182,This breaks unless we ignore a decoding error.,not
mitmproxy/test/mitmproxy/test_http.py,168,copy creates a different uuid,not
mitmproxy/test/mitmproxy/test_http.py,174,to change the state,not
mitmproxy/test/mitmproxy/test_optmanager.py,150,pytest.raises keeps a reference here that interferes with the cleanup test,not
mitmproxy/test/mitmproxy/test_optmanager.py,151,further down.,not
mitmproxy/test/mitmproxy/test_optmanager.py,385,Nonexistent options ignore,not
mitmproxy/test/mitmproxy/test_flowfilter.py,179,Cyrillic,not
mitmproxy/test/mitmproxy/test_flowfilter.py,181,Chinese,not
mitmproxy/test/mitmproxy/test_flowfilter.py,183,Hindi,not
mitmproxy/test/mitmproxy/test_flowfilter.py,185,Arabic,not
mitmproxy/test/mitmproxy/test_flowfilter.py,187,Greek,not
mitmproxy/test/mitmproxy/test_flowfilter.py,189,Hebrew,not
mitmproxy/test/mitmproxy/test_flowfilter.py,191,Japanese,not
mitmproxy/test/mitmproxy/test_flowfilter.py,193,Korean,not
mitmproxy/test/mitmproxy/test_flowfilter.py,195,Latin,not
mitmproxy/test/mitmproxy/test_flowfilter.py,324,Messages sent by client or server,not
mitmproxy/test/mitmproxy/test_flowfilter.py,329,Messages sent by client,not
mitmproxy/test/mitmproxy/test_flowfilter.py,334,Messages sent by server,not
mitmproxy/test/mitmproxy/test_flowfilter.py,392,Request headers,not
mitmproxy/test/mitmproxy/test_flowfilter.py,395,Response headers,not
mitmproxy/test/mitmproxy/test_flowfilter.py,402,Request content-type,not
mitmproxy/test/mitmproxy/test_flowfilter.py,405,Response content-type,not
mitmproxy/test/mitmproxy/test_flowfilter.py,463,Messages sent by client or server,not
mitmproxy/test/mitmproxy/test_flowfilter.py,468,Messages sent by client,not
mitmproxy/test/mitmproxy/test_flowfilter.py,473,Messages sent by server,not
mitmproxy/test/mitmproxy/test_flowfilter.py,581,The text is a string with leading and trailing whitespace stripped; if the source is not available it is None.,not
mitmproxy/test/mitmproxy/test_exceptions.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/__init__.py,1,Silence third-party modules,not
mitmproxy/test/mitmproxy/test_proxy.py,57,binding to 0.0.0.0:1 works without special permissions on Windows and macOS Mojave+,not
mitmproxy/test/mitmproxy/test_controller.py,101,hide warnings on deletion,not
mitmproxy/test/mitmproxy/utils/test_bits.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/utils/test_sliding_window.py,7,prev this  next  next2,not
mitmproxy/test/mitmproxy/utils/test_typecheck.py,80,"this is not covered by check_option_type, but still belongs in this module",not
mitmproxy/test/mitmproxy/proxy/test_root_context.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/proxy/test_server.py,38,"In Upstream mode with SSL, we may already have a previous CONNECT",not
mitmproxy/test/mitmproxy/proxy/test_server.py,39,request.,not
mitmproxy/test/mitmproxy/proxy/test_server.py,58,"In reverse proxy mode, we expect to use the upstream host as our SNI value",not
mitmproxy/test/mitmproxy/proxy/test_server.py,105,Test that we get the original SSL cert,not
mitmproxy/test/mitmproxy/proxy/test_server.py,114,Test Non-HTTP traffic,not
mitmproxy/test/mitmproxy/proxy/test_server.py,115,this results in just 100 random bytes,not
mitmproxy/test/mitmproxy/proxy/test_server.py,116,mitmproxy responds with bad gateway,not
mitmproxy/test/mitmproxy/proxy/test_server.py,120,pathoc tries to parse answer as HTTP,not
mitmproxy/test/mitmproxy/proxy/test_server.py,139,Test that we get the original SSL cert,not
mitmproxy/test/mitmproxy/proxy/test_server.py,148,Test Non-HTTP traffic,not
mitmproxy/test/mitmproxy/proxy/test_server.py,149,this results in just 100 random bytes,not
mitmproxy/test/mitmproxy/proxy/test_server.py,150,mitmproxy responds with bad gateway,not
mitmproxy/test/mitmproxy/proxy/test_server.py,154,pathoc parses answer as HTTP,not
mitmproxy/test/mitmproxy/proxy/test_server.py,182,Test that we get the original SSL cert,not
mitmproxy/test/mitmproxy/proxy/test_server.py,191,Make sure that TCP messages are in the event log.,not
mitmproxy/test/mitmproxy/proxy/test_server.py,192,Re-enable and fix this when we start keeping TCPFlows in the state.,not
mitmproxy/test/mitmproxy/proxy/test_server.py,193,"assert any(""305"" in m for m in self.master.tlog)",not
mitmproxy/test/mitmproxy/proxy/test_server.py,194,"assert any(""306"" in m for m in self.master.tlog)",not
mitmproxy/test/mitmproxy/proxy/test_server.py,212,"Add a body, so we have a content-length header, which combined with",not
mitmproxy/test/mitmproxy/proxy/test_server.py,213,HTTP1.1 means the connection is kept alive.,not
mitmproxy/test/mitmproxy/proxy/test_server.py,216,Lets sanity check that the connection does indeed stay open by,not
mitmproxy/test/mitmproxy/proxy/test_server.py,217,issuing two requests over the same connection,not
mitmproxy/test/mitmproxy/proxy/test_server.py,223,Now check that the connection is closed as the client specifies,not
mitmproxy/test/mitmproxy/proxy/test_server.py,227,"There's a race here, which means we can get any of a number of errors.",not
mitmproxy/test/mitmproxy/proxy/test_server.py,228,"Rather than introduce yet another sleep into the test suite, we just",not
mitmproxy/test/mitmproxy/proxy/test_server.py,229,relax the Exception specification.,not
mitmproxy/test/mitmproxy/proxy/test_server.py,239,"Server has disconnected. Mitmproxy should detect this, and reconnect.",not
mitmproxy/test/mitmproxy/proxy/test_server.py,408,We only test for a single invalid cert here.,not
mitmproxy/test/mitmproxy/proxy/test_server.py,409,"Actual testing of different root-causes (invalid hostname, expired, ...)",not
mitmproxy/test/mitmproxy/proxy/test_server.py,410,is done in mitmproxy.net.,not
mitmproxy/test/mitmproxy/proxy/test_server.py,448,default value,not
mitmproxy/test/mitmproxy/proxy/test_server.py,507,read server greeting,not
mitmproxy/test/mitmproxy/proxy/test_server.py,508,"the request doesn't matter, error response from handshake will be read anyway.",not
mitmproxy/test/mitmproxy/proxy/test_server.py,521,"the request doesn't matter, error response from handshake will be read anyway.",not
mitmproxy/test/mitmproxy/proxy/test_server.py,609,test that we notice at least 1 sec delay between timestamps,not
mitmproxy/test/mitmproxy/proxy/test_server.py,610,in response object,not
mitmproxy/test/mitmproxy/proxy/test_server.py,615,"timestamp_start might fire a bit late, so we play safe and only require 300ms.",SATD
mitmproxy/test/mitmproxy/proxy/test_server.py,620,test that we notice a delay between timestamps in request object,not
mitmproxy/test/mitmproxy/proxy/test_server.py,624,"call pathod server, wait a second to complete the request",not
mitmproxy/test/mitmproxy/proxy/test_server.py,635,sanity test for our low level request,not
mitmproxy/test/mitmproxy/proxy/test_server.py,636,"timestamp_start might fire a bit late, so we play safe and only require 300ms.",SATD
mitmproxy/test/mitmproxy/proxy/test_server.py,640,tests that the client_conn a tcp connection has a tcp_setup_timestamp,not
mitmproxy/test/mitmproxy/proxy/test_server.py,647,a bit hacky: make sure that we don't just read the headers only.,SATD
mitmproxy/test/mitmproxy/proxy/test_server.py,678,tests that the ssl timestamp is present when ssl is used,not
mitmproxy/test/mitmproxy/proxy/test_server.py,686,tests that the ssl timestamp is present when ssl is used,not
mitmproxy/test/mitmproxy/proxy/test_server.py,699,"This part should have no impact, but it should also not cause any exceptions.",not
mitmproxy/test/mitmproxy/proxy/test_server.py,705,This is the actual redirection.,not
mitmproxy/test/mitmproxy/proxy/test_server.py,768,a request with 100k of data but without content-length,not
mitmproxy/test/mitmproxy/proxy/test_server.py,777,simple request with streaming turned on,not
mitmproxy/test/mitmproxy/proxy/test_server.py,781,"now send back 100k of data, streamed but not chunked",not
mitmproxy/test/mitmproxy/proxy/test_server.py,849,Nothing should have hit the server,not
mitmproxy/test/mitmproxy/proxy/test_server.py,863,The server should have seen a request,not
mitmproxy/test/mitmproxy/proxy/test_server.py,955,"CONNECT from pathoc to chain[0],",not
mitmproxy/test/mitmproxy/proxy/test_server.py,958,request from pathoc to chain[0],not
mitmproxy/test/mitmproxy/proxy/test_server.py,959,"CONNECT from proxy to chain[1],",not
mitmproxy/test/mitmproxy/proxy/test_server.py,962,request from proxy to chain[1],not
mitmproxy/test/mitmproxy/proxy/test_server.py,963,request from chain[0] (regular proxy doesn't store CONNECTs),not
mitmproxy/test/mitmproxy/proxy/test_server.py,968,skip chain[0].,not
mitmproxy/test/mitmproxy/proxy/test_server.py,1056,First request goes through all three proxies exactly once,not
mitmproxy/test/mitmproxy/proxy/test_server.py,1067,Upstream sees two requests due to reconnection attempt,not
mitmproxy/test/mitmproxy/proxy/test_server.py,1072,"Reconnection failed, so we're now disconnected",not
mitmproxy/test/mitmproxy/proxy/protocol/test_websocket.py,298,We don't send payload to other end,not
mitmproxy/test/mitmproxy/proxy/protocol/test_websocket.py,388,with pytest.raises(exceptions.TcpDisconnect):,not
mitmproxy/test/mitmproxy/proxy/protocol/test_websocket.py,413,Reader.safe_read get nothing as result,not
mitmproxy/test/mitmproxy/proxy/protocol/test_websocket.py,421,Message not appended as the final frame isn't received,not
mitmproxy/test/mitmproxy/proxy/protocol/test_rawtcp.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/proxy/protocol/test_base.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,1,coding=utf-8,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,27,inspect the log:,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,28,for msg in self.proxy.tmaster.tlog:,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,29,print(msg),not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,126,send CONNECT request,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,140,read CONNECT response,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,215,Ignore UnicodeWarning:,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,216,h2/utilities.py:64: UnicodeWarning: Unicode equal comparison,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,217,failed to convert both arguments to Unicode - interpreting,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,218,them as being unequal.,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,219,"elif header[0] in (b'cookie', u'cookie') and len(header[1]) < 20:",not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,293,Ignore UnicodeWarning:,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,294,h2/utilities.py:64: UnicodeWarning: Unicode equal comparison,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,295,failed to convert both arguments to Unicode - interpreting,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,296,them as being unequal.,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,297,"elif header[0] in (b'cookie', u'cookie') and len(header[1]) < 20:",not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,376,Ignore UnicodeWarning:,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,377,h2/utilities.py:64: UnicodeWarning: Unicode equal comparison,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,378,failed to convert both arguments to Unicode - interpreting,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,379,them as being unequal.,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,380,"elif header[0] in (b'cookie', u'cookie') and len(header[1]) < 20:",not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,620,ignore requests initiated by push promises,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,777,the other two bodies might not be transmitted before the reset,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,847,this will exceed MAX_CONCURRENT_STREAMS on the server connection,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http2.py,848,and cause mitmproxy to throttle stream creation to the server,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/proxy/protocol/test_http1.py,52,"call pathod server, wait a second to complete the request",not
mitmproxy/test/mitmproxy/proxy/protocol/test_http1.py,106,response with 10000 bytes,not
mitmproxy/test/mitmproxy/proxy/protocol/test_http1.py,110,request with 10000 bytes,not
mitmproxy/test/mitmproxy/proxy/modes/test_reverse_proxy.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/proxy/modes/test_socks_proxy.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/proxy/modes/test_http_proxy.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/proxy/modes/test_transparent_proxy.py,1,TODO: write tests,SATD
mitmproxy/test/mitmproxy/net/test_check.py,1,coding=utf-8,not
mitmproxy/test/mitmproxy/net/test_check.py,12,Allow underscore,not
mitmproxy/test/mitmproxy/net/test_check.py,16,IP Address Validations,not
mitmproxy/test/mitmproxy/net/test_check.py,24,TLD must be between 2 and 63 chars,not
mitmproxy/test/mitmproxy/net/test_check.py,30,misc characters test,not
mitmproxy/test/mitmproxy/net/test_check.py,38,Every label must be between 1 and 63 chars,not
mitmproxy/test/mitmproxy/net/test_check.py,47,Misc Underscore Test Cases,not
mitmproxy/test/mitmproxy/net/test_check.py,55,Misc Dash/Hyphen/Minus Test Cases,not
mitmproxy/test/mitmproxy/net/test_check.py,63,Misc Combo Test Cases,not
mitmproxy/test/mitmproxy/net/test_tls.py,17,record layer,not
mitmproxy/test/mitmproxy/net/test_tls.py,18,handshake header,not
mitmproxy/test/mitmproxy/net/test_tls.py,152,record layer,not
mitmproxy/test/mitmproxy/net/test_tls.py,153,handshake header,not
mitmproxy/test/mitmproxy/net/test_tcp.py,47,Hang as long as the client connection is alive,not
mitmproxy/test/mitmproxy/net/test_tcp.py,52,Client connection is dead...,not
mitmproxy/test/mitmproxy/net/test_tcp.py,102,"We may get an ipv4-mapped ipv6 address here, e.g. ::ffff:127.0.0.1.",not
mitmproxy/test/mitmproxy/net/test_tcp.py,103,"Those still appear as ""127.0.0.1"" in the table, so we need to strip the prefix.",not
mitmproxy/test/mitmproxy/net/test_tcp.py,122,port probably already in use,not
mitmproxy/test/mitmproxy/net/test_tcp.py,239,Verification errors should be saved even if connection isn't aborted,not
mitmproxy/test/mitmproxy/net/test_tcp.py,240,aborted,not
mitmproxy/test/mitmproxy/net/test_tcp.py,253,Verification errors should be saved even if connection isn't aborted,not
mitmproxy/test/mitmproxy/net/test_tcp.py,273,Unknown issuing certificate authority for first certificate,not
mitmproxy/test/mitmproxy/net/test_tcp.py,426,"Not working for OpenSSL 1.1.1, see",not
mitmproxy/test/mitmproxy/net/test_tcp.py,427,https://github.com/pyca/pyopenssl/blob/fc802df5c10f0d1cd9749c94887d652fa26db6fb/src/OpenSSL/SSL.py#L1192-L1196,not
mitmproxy/test/mitmproxy/net/test_tcp.py,449,"Not working for OpenSSL 1.1.1, see",not
mitmproxy/test/mitmproxy/net/test_tcp.py,450,https://github.com/pyca/pyopenssl/blob/fc802df5c10f0d1cd9749c94887d652fa26db6fb/src/OpenSSL/SSL.py#L1192-L1196,not
mitmproxy/test/mitmproxy/net/test_tcp.py,496,Exercise SSL.ZeroReturnError,not
mitmproxy/test/mitmproxy/net/test_tcp.py,513,Exercise SSL.SysCallError,not
mitmproxy/test/mitmproxy/net/test_tcp.py,672,Test __getattr__,not
mitmproxy/test/mitmproxy/net/test_socks.py,152,Test ATYP=0x01 (IPV4),not
mitmproxy/test/mitmproxy/net/test_socks.py,165,Test ATYP=0x04 (IPV6),not
mitmproxy/test/mitmproxy/net/http/test_message.py,1,-*- coding: utf-8 -*-,not
mitmproxy/test/mitmproxy/net/http/test_message.py,17,"Set str, get raw bytes",not
mitmproxy/test/mitmproxy/net/http/test_message.py,20,"Set raw bytes, get decoded",not
mitmproxy/test/mitmproxy/net/http/test_message.py,21,use uppercase so that we can also cover request.method,not
mitmproxy/test/mitmproxy/net/http/test_message.py,23,"Set bytes, get raw bytes",not
mitmproxy/test/mitmproxy/net/http/test_message.py,27,Set UTF8,not
mitmproxy/test/mitmproxy/net/http/test_message.py,30,Don't fail on garbage,not
mitmproxy/test/mitmproxy/net/http/test_message.py,34,foo.bar = foo.bar should not cause any side effects.,not
mitmproxy/test/mitmproxy/net/http/test_message.py,53,ResponseData.from_state(),not
mitmproxy/test/mitmproxy/net/http/test_message.py,235,"""鏄庝集"" is decoded form of \xe6\x98\x8e\xe4\xbc\xaf in gb18030",not
mitmproxy/test/mitmproxy/net/http/test_request.py,94,path can also be None.,not
mitmproxy/test/mitmproxy/net/http/test_request.py,103,Test IDNA encoding,not
mitmproxy/test/mitmproxy/net/http/test_request.py,104,"Set str, get raw bytes",not
mitmproxy/test/mitmproxy/net/http/test_request.py,107,"Set raw bytes, get decoded",not
mitmproxy/test/mitmproxy/net/http/test_request.py,110,"Set bytes, get raw bytes",not
mitmproxy/test/mitmproxy/net/http/test_request.py,113,IDNA encoding is not bijective,not
mitmproxy/test/mitmproxy/net/http/test_request.py,117,Don't fail on garbage,not
mitmproxy/test/mitmproxy/net/http/test_request.py,121,foo.bar = foo.bar should not cause any side effects.,not
mitmproxy/test/mitmproxy/net/http/test_request.py,209,Without host header,not
mitmproxy/test/mitmproxy/net/http/test_request.py,212,Same port as self.port (22),not
mitmproxy/test/mitmproxy/net/http/test_request.py,215,Different ports,not
mitmproxy/test/mitmproxy/net/http/test_request.py,219,Empty host,not
mitmproxy/test/mitmproxy/net/http/test_request.py,224,Invalid IDNA,not
mitmproxy/test/mitmproxy/net/http/test_request.py,230,Without host header,not
mitmproxy/test/mitmproxy/net/http/test_request.py,233,Same port as self.port (22),not
mitmproxy/test/mitmproxy/net/http/test_request.py,236,Different ports,not
mitmproxy/test/mitmproxy/net/http/test_request.py,339,no-op if there is no accept_encoding header.,not
mitmproxy/test/mitmproxy/net/http/test_url.py,38,Invalid IDNA,not
mitmproxy/test/mitmproxy/net/http/test_url.py,41,Invalid PATH,not
mitmproxy/test/mitmproxy/net/http/test_url.py,44,Null byte in host,not
mitmproxy/test/mitmproxy/net/http/test_url.py,47,Invalid IPv6 URL - see http://www.ietf.org/rfc/rfc2732.txt,not
mitmproxy/test/mitmproxy/net/http/test_url.py,65,Port out of range,not
mitmproxy/test/mitmproxy/net/http/test_url.py,78,We ignore the byte 126: '~' because of an incompatibility in Python 3.6 and 3.7,not
mitmproxy/test/mitmproxy/net/http/test_url.py,79,In 3.6 it is escaped as %7E,not
mitmproxy/test/mitmproxy/net/http/test_url.py,80,In 3.7 it stays as ASCII character '~',not
mitmproxy/test/mitmproxy/net/http/test_url.py,81,https://bugs.python.org/issue16285,not
mitmproxy/test/mitmproxy/net/http/test_url.py,92,7E or ~ is excluded!,not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,261,Comma Separated Variant of Set-Cookie Headers,not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,306,"Invalid expires format, sent to us by Reddit.",not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,320,https://github.com/mitmproxy/mitmproxy/issues/773,not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,324,https://github.com/mitmproxy/mitmproxy/issues/1118,not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,330,https://github.com/mitmproxy/mitmproxy/issues/2250,not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,337,Freeze time,not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,354,A cookie can be expired,not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,355,by setting the expire time in the past,not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,358,or by setting Max-Age to 0,not
mitmproxy/test/mitmproxy/net/http/test_cookies.py,361,or both,not
mitmproxy/test/mitmproxy/net/http/test_encoding.py,87,should be cached,not
mitmproxy/test/mitmproxy/net/http/test_encoding.py,91,the other way around as well,not
mitmproxy/test/mitmproxy/net/http/test_encoding.py,95,different encoding,not
mitmproxy/test/mitmproxy/net/http/test_encoding.py,100,This is not in the cache anymore,not
mitmproxy/test/mitmproxy/net/http/test_response.py,159,Weird that this is not exact...,not
mitmproxy/test/mitmproxy/net/http/test_response.py,165,"Cookie refreshing is tested in test_cookies, we just make sure that it's triggered here.",not
mitmproxy/test/mitmproxy/net/http/http1/test_read.py,162,Expect: 100-continue,not
mitmproxy/test/mitmproxy/net/http/http1/test_read.py,167,Expect: 100-continue,not
mitmproxy/test/mitmproxy/net/http/http1/test_read.py,173,http://tools.ietf.org/html/rfc7230#section-3.3,not
mitmproxy/test/mitmproxy/net/http/http1/test_read.py,188,chunked,not
mitmproxy/test/mitmproxy/net/http/http1/test_read.py,193,explicit length,not
mitmproxy/test/mitmproxy/net/http/http1/test_read.py,203,more than 1 content-length headers with same value,not
mitmproxy/test/mitmproxy/net/http/http1/test_read.py,208,more than 1 content-length headers with conflicting value,not
mitmproxy/test/mitmproxy/net/http/http1/test_read.py,214,no length,not
mitmproxy/test/mitmproxy/net/http/http1/test_read.py,281,https://github.com/mitmproxy/mitmproxy/issues/784,not
mitmproxy/test/mitmproxy/net/http/http1/test_assemble.py,79,https://github.com/mitmproxy/mitmproxy/issues/186,not
mitmproxy/test/mitmproxy/net/http/http1/test_assemble.py,87,https://github.com/mitmproxy/mitmproxy/issues/186,not
mitmproxy/test/mitmproxy/net/websockets/test_masker.py,15,noqa,not
mitmproxy/test/mitmproxy/net/data/verificationcerts/generate.py,56,create trusted root CA,not
mitmproxy/test/mitmproxy/net/data/verificationcerts/generate.py,66,create trusted leaf cert.,not
mitmproxy/test/mitmproxy/net/data/verificationcerts/generate.py,69,create self-signed cert,not
mitmproxy/test/mitmproxy/tools/web/test_app.py,56,tornado disallows POST without content by default.,not
mitmproxy/test/mitmproxy/tools/web/test_app.py,92,restore,not
mitmproxy/test/mitmproxy/tools/web/test_app.py,316,trigger on_close by opening a second connection.,not
mitmproxy/test/mitmproxy/tools/web/test_app.py,322,"Set some value as constant, so that _tflow.js would not change every time.",not
mitmproxy/test/mitmproxy/tools/console/test_statusbar.py,35,this already causes a redraw,not
mitmproxy/test/mitmproxy/tools/console/test_commander.py,11,This runs before each test,not
mitmproxy/test/mitmproxy/tools/console/test_commander.py,24,This runs after each test,not
mitmproxy/test/mitmproxy/tools/console/test_commander.py,68,Don't let users type a space before starting a command,not
mitmproxy/test/mitmproxy/tools/console/test_commander.py,69,as a usability feature,not
mitmproxy/test/mitmproxy/tools/console/test_commander.py,93,Do it again to make sure it won't go negative,not
mitmproxy/test/mitmproxy/tools/console/test_commander.py,103,Make sure cursor won't go past the text,not
mitmproxy/test/mitmproxy/tools/console/test_commander.py,107,Make sure cursor goes left and then back right,not
mitmproxy/test/mitmproxy/contentviews/test_api.py,21,repeated addition causes exception,not
mitmproxy/test/mitmproxy/contentviews/test_javascript.py,16,invalid utf-8,not
mitmproxy/test/mitmproxy/contentviews/test_json.py,12,utf8 with chinese characters,not
mitmproxy/test/mitmproxy/contentviews/test_wbxml.py,13,File taken from https://github.com/davidpshaw/PyWBXMLDecoder/tree/master/wbxml_samples,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,7,no textual data,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,13,with textual data,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,28,with compressed textual data,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,43,UTF-8 international text - english,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,58,check gamma value,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,64,check aspect value,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,79,check comment,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,87,check background,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,95,check working with color table,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,109,check app0,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,117,check com,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,126,check app1,not
mitmproxy/test/mitmproxy/contentviews/image/test_image_parser.py,137,check multiple segments,not
mitmproxy/test/mitmproxy/addons/test_eventstore.py,18,test .log(),not
mitmproxy/test/mitmproxy/addons/test_eventstore.py,25,test .clear(),not
mitmproxy/test/mitmproxy/addons/test_eventstore.py,44,overflow,not
mitmproxy/test/mitmproxy/addons/test_view.py,82,These all just call update,not
mitmproxy/test/mitmproxy/addons/test_view.py,132,These all just call update,not
mitmproxy/test/mitmproxy/addons/test_view.py,436,Simple add,not
mitmproxy/test/mitmproxy/addons/test_view.py,441,Filter change triggers refresh,not
mitmproxy/test/mitmproxy/addons/test_view.py,449,An update that results in a flow being added to the view,not
mitmproxy/test/mitmproxy/addons/test_view.py,456,An update that does not affect the view just sends update,not
mitmproxy/test/mitmproxy/addons/test_view.py,463,An update for a flow in state but not view does not do anything,not
mitmproxy/test/mitmproxy/addons/test_view.py,502,Special case - initialising with a view that already contains data,not
mitmproxy/test/mitmproxy/addons/test_view.py,509,Start empty,not
mitmproxy/test/mitmproxy/addons/test_view.py,519,Try to set to something not in view,not
mitmproxy/test/mitmproxy/addons/test_script.py,15,We want this to be speedy for testing,not
mitmproxy/test/mitmproxy/addons/test_clientplayback.py,67,Disconnect error,not
mitmproxy/test/mitmproxy/addons/test_clientplayback.py,78,# Port error,not
mitmproxy/test/mitmproxy/addons/test_clientplayback.py,82,"In upstream mode, we get a 502 response from the upstream proxy server.",not
mitmproxy/test/mitmproxy/addons/test_clientplayback.py,83,"In upstream mode with ssl, the replay will fail as we cannot establish",not
mitmproxy/test/mitmproxy/addons/test_clientplayback.py,84,SSL with the upstream proxy.,not
mitmproxy/test/mitmproxy/addons/test_command_history.py,191,"These instances haven't yet added a new command, so they haven't",not
mitmproxy/test/mitmproxy/addons/test_command_history.py,192,yet reloaded their commands from the command file.,not
mitmproxy/test/mitmproxy/addons/test_command_history.py,193,"This is expected, because if the user is filtering a command on",not
mitmproxy/test/mitmproxy/addons/test_command_history.py,194,"another window, we don't want to interfere with that",not
mitmproxy/test/mitmproxy/addons/test_command_history.py,200,"Since the second instanced added a new command, its list of",not
mitmproxy/test/mitmproxy/addons/test_command_history.py,201,saved commands has been updated to have the commands from the,not
mitmproxy/test/mitmproxy/addons/test_command_history.py,202,first instance + its own commands,not
mitmproxy/test/mitmproxy/addons/test_command_history.py,210,Third instance is still empty as it has not yet ran any command,not
mitmproxy/test/mitmproxy/addons/test_core.py,203,Folders should work.,not
mitmproxy/test/mitmproxy/addons/test_core.py,205,"Files, too.",not
mitmproxy/test/mitmproxy/addons/test_export.py,8,heh,not
mitmproxy/test/mitmproxy/addons/test_export.py,67,shlex.quote doesn't support a bytes object,not
mitmproxy/test/mitmproxy/addons/test_export.py,68,see https://github.com/python/cpython/pull/10871,not
mitmproxy/test/mitmproxy/addons/test_export.py,113,shlex.quote doesn't support a bytes object,not
mitmproxy/test/mitmproxy/addons/test_export.py,114,see https://github.com/python/cpython/pull/10871,not
mitmproxy/test/mitmproxy/addons/test_session.py,31,To make tests quicker,not
mitmproxy/test/mitmproxy/addons/test_session.py,119,"Verify that flow has been updated, not duplicated",not
mitmproxy/test/mitmproxy/addons/test_session.py,191,Need to test for configure,not
mitmproxy/test/mitmproxy/addons/test_session.py,192,Need to test for set_order,not
mitmproxy/test/mitmproxy/addons/test_session.py,207,Content length is wrong for some reason -- quick fix,not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,115,NOTE: parameters are mutually exclusive in options,not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,124,same parameters,not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,145,same content,not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,147,distint content (note only x-www-form-urlencoded payload is analysed),not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,269,same parameters,not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,271,ignored parameters !=,not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,274,missing parameter,not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,277,ignorable parameter added,not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,280,not ignorable parameter changed,not
mitmproxy/test/mitmproxy/addons/test_serverplayback.py,283,not ignorable parameter missing,not
mitmproxy/test/mitmproxy/addons/test_stickycookie.py,74,Test setting of multiple cookies,not
mitmproxy/test/mitmproxy/addons/test_stickycookie.py,88,Test setting of weird cookie keys,not
mitmproxy/test/mitmproxy/addons/test_stickycookie.py,106,Test overwriting of a cookie value,not
mitmproxy/test/mitmproxy/addons/test_stickycookie.py,121,Test that a cookie is be deleted,not
mitmproxy/test/mitmproxy/addons/test_stickycookie.py,122,by setting the expire time in the past,not
mitmproxy/test/mitmproxy/addons/test_block.py,9,block_global: loopback,not
mitmproxy/test/mitmproxy/addons/test_block.py,12,block_global: private,not
mitmproxy/test/mitmproxy/addons/test_block.py,21,block_global: global,not
mitmproxy/test/mitmproxy/addons/test_block.py,32,block_private: loopback,not
mitmproxy/test/mitmproxy/addons/test_block.py,35,block_private: private,not
mitmproxy/test/mitmproxy/addons/test_block.py,44,block_private: global,not
mitmproxy/test/mitmproxy/data/addonscripts/recorder/error.py,5,Intended Syntax Error,not
mitmproxy/test/mitmproxy/io/test_tnetstring.py,27,noqa,not
mitmproxy/test/mitmproxy/io/test_tnetstring.py,33,The probability of generating a scalar value increases as the depth increase.,not
mitmproxy/test/mitmproxy/io/test_tnetstring.py,34,This ensures that we bottom out eventually.,not
mitmproxy/test/mitmproxy/io/test_io.py,1,TODO: write tests,SATD
mitmproxy/test/release/test_cibuild.py,49,"Simulates a PR. We build everything, but don't have access to secret",not
mitmproxy/test/release/test_cibuild.py,50,credential env variables.,not
mitmproxy/test/release/test_cibuild.py,99,Simulates an ordinary commit on the master branch.,not
mitmproxy/test/release/test_cibuild.py,120,Simulates a tagged release on a release branch.,not
mitmproxy/test/release/test_cibuild.py,145,Simulates a non-release tag on a branch.,not
mitmproxy/test/release/test_cibuild.py,170,Simulates a commit on a development branch on the main repo,not
mitmproxy/test/release/test_cibuild.py,193,Simulates a commit on a release maintenance branch on the main repo,not
mitmproxy/test/release/test_cibuild.py,254,regular snapshot,not
mitmproxy/test/release/test_cibuild.py,255,"forgot to remove "".dev"" on bump",not
mitmproxy/test/release/test_cibuild.py,256,"forgot to re-add "".dev""",not
mitmproxy/test/release/test_cibuild.py,257,version mismatch,not
mitmproxy/test/release/test_cibuild.py,258,regular release,not
mitmproxy/test/release/test_cibuild.py,259,non-canonical.,not
mitmproxy/test/release/test_cibuild.py,260,tagged test/dev release,not
mitmproxy/test/release/test_cibuild.py,261,"tagged, but without v prefix",not
mitmproxy/test/examples/test_xss_scanner.py,9,First type of exploit: <script>PAYLOAD</script>,not
mitmproxy/test/examples/test_xss_scanner.py,10,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,29,Non-Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,35,Second type of exploit: <script>t='PAYLOAD'</script>,not
mitmproxy/test/examples/test_xss_scanner.py,36,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,47,Non-Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,53,"Third type of exploit: <script>t=""PAYLOAD""</script>",not
mitmproxy/test/examples/test_xss_scanner.py,54,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,65,Non-Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,71,Fourth type of exploit: <a href='PAYLOAD'>Test</a>,not
mitmproxy/test/examples/test_xss_scanner.py,72,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,82,Non-Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,88,"Fifth type of exploit: <a href=""PAYLOAD"">Test</a>",not
mitmproxy/test/examples/test_xss_scanner.py,89,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,99,Non-Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,105,Sixth type of exploit: <a href=PAYLOAD>Test</a>,not
mitmproxy/test/examples/test_xss_scanner.py,106,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,116,Non-Exploitable,not
mitmproxy/test/examples/test_xss_scanner.py,123,Seventh type of exploit: <html>PAYLOAD</html>,not
mitmproxy/test/examples/test_xss_scanner.py,124,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,134,Non-Exploitable,not
mitmproxy/test/examples/test_xss_scanner.py,140,Eighth type of exploit: <a href=PAYLOAD>Test</a>,not
mitmproxy/test/examples/test_xss_scanner.py,141,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,151,Non-Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,158,"Ninth type of exploit: <a href=""STUFF PAYLOAD"">Test</a>",not
mitmproxy/test/examples/test_xss_scanner.py,159,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,169,Non-Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,176,Tenth type of exploit: <a href='STUFF PAYLOAD'>Test</a>,not
mitmproxy/test/examples/test_xss_scanner.py,177,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,187,Non-Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,194,Eleventh type of exploit: <a href=STUFF_PAYLOAD>Test</a>,not
mitmproxy/test/examples/test_xss_scanner.py,195,Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,205,Non-Exploitable:,not
mitmproxy/test/examples/test_xss_scanner.py,349,"self, url: str, injection_point: str, exploit: str, line: str",not
mitmproxy/test/examples/test_xss_scanner.py,376,It only uses the request cookies,not
mitmproxy/test/examples/test_examples.py,90,Rewrite by reverse proxy mode,not
mitmproxy/test/examples/test_har_dump.py,16,Create a dummy flow for testing,not
mitmproxy/pathod/pathoc_cmdline.py,225,pragma: no cover,not
mitmproxy/pathod/pathod.py,16,noqa,not
mitmproxy/pathod/pathod.py,183,"If this is a websocket initiation, we respond with a proper",not
mitmproxy/pathod/pathod.py,184,"server response, unless over-ridden.",not
mitmproxy/pathod/pathod.py,391,pragma: no cover,not
mitmproxy/pathod/pathod.py,433,pragma: no cover,not
mitmproxy/pathod/test.py,6,noqa,not
mitmproxy/pathod/utils.py,4,noqa,not
mitmproxy/pathod/utils.py,21,FIXME: change this name,SATD
mitmproxy/pathod/utils.py,25,pragma: no cover,not
mitmproxy/pathod/pathod_cmdline.py,233,pragma: no cover,not
mitmproxy/pathod/pathoc.py,129,pragma: no cover,not
mitmproxy/pathod/pathoc.py,130,"this is not reliably triggered due to its nature, so we exclude it from coverage.",not
mitmproxy/pathod/pathoc.py,158,SSL,not
mitmproxy/pathod/pathoc.py,166,HTTP/2,not
mitmproxy/pathod/pathoc.py,171,Websockets,not
mitmproxy/pathod/pathoc.py,174,Network,not
mitmproxy/pathod/pathoc.py,177,Output control,not
mitmproxy/pathod/pathoc.py,437,build a dummy request to read the response,not
mitmproxy/pathod/pathoc.py,438,ideally this would be returned directly from language.serve,not
mitmproxy/pathod/pathoc.py,493,"elif isinstance(r, language.http2.Frame):",not
mitmproxy/pathod/pathoc.py,494,TODO: do something,SATD
mitmproxy/pathod/pathoc.py,497,pragma: no cover,not
mitmproxy/pathod/pathoc.py,504,"If we are replaying more than once, we must convert the request generators to lists",not
mitmproxy/pathod/pathoc.py,505,or they will be exhausted after the first run.,not
mitmproxy/pathod/pathoc.py,506,"This is bad for the edge-case where get:/:x10000000 (see 0da3e51) is combined with -n 2,",not
mitmproxy/pathod/pathoc.py,507,but does not matter otherwise.,not
mitmproxy/pathod/pathoc.py,565,"We consume the queue when we can, so it doesn't build up.",not
mitmproxy/pathod/protocols/http2.py,96,more accurate timestamp_start,not
mitmproxy/pathod/protocols/http2.py,143,more accurate timestamp_start,not
mitmproxy/pathod/protocols/http2.py,243,server announces own settings,not
mitmproxy/pathod/protocols/http2.py,244,server acks my settings,not
mitmproxy/pathod/protocols/http2.py,250,pragma: no cover,not
mitmproxy/pathod/protocols/http2.py,256,pragma: no cover,not
mitmproxy/pathod/protocols/http2.py,294,servers must use even stream ids,not
mitmproxy/pathod/protocols/http2.py,297,clients must use odd stream ids,not
mitmproxy/pathod/protocols/http2.py,340,pragma: no cover,not
mitmproxy/pathod/protocols/http2.py,358,pragma: no cover,not
mitmproxy/pathod/language/generators.py,52,bytearray has consistent behaviour on both Python 2 and 3,not
mitmproxy/pathod/language/generators.py,53,while bytes does not,not
mitmproxy/pathod/language/base.py,8,noqa,not
mitmproxy/pathod/language/base.py,28,TODO: refactor this into the protocol,SATD
mitmproxy/pathod/language/base.py,73,pragma: no cover,not
mitmproxy/pathod/language/base.py,80,pragma: no cover,not
mitmproxy/pathod/language/base.py,266,pragma: no cover,not
mitmproxy/pathod/language/base.py,340,"If it's a string, we were passed one of the options, so we lower-case",not
mitmproxy/pathod/language/base.py,341,it to be canonical. The user can specify a different case by using a,not
mitmproxy/pathod/language/base.py,342,string value literal.,not
mitmproxy/pathod/language/base.py,346,Find the exact option value in a case-insensitive way,not
mitmproxy/pathod/language/base.py,454,This check will fail if we know the length upfront,not
mitmproxy/pathod/language/base.py,467,This check will fail if we don't know the length upfront - i.e. for,not
mitmproxy/pathod/language/base.py,468,file inputs,not
mitmproxy/pathod/language/message.py,2,noqa,not
mitmproxy/pathod/language/message.py,74,pragma: no cover,not
mitmproxy/pathod/language/message.py,84,Careful not to log any VALUE specs without sanitizing them first.,not
mitmproxy/pathod/language/message.py,85,We truncate at 1k.,not
mitmproxy/pathod/language/writer.py,5,It's not clear what the upper limit for time.sleep is. It's lower than the,not
mitmproxy/pathod/language/writer.py,6,maximum int or float. 1 year should do.,not
mitmproxy/pathod/language/writer.py,56,Remainders,not
mitmproxy/pathod/language/writer.py,67,pragma: no cover,not
mitmproxy/pathod/language/http.py,10,"TODO: use mitmproxy.net.semantics.protocol assemble method,",SATD
mitmproxy/pathod/language/http.py,11,instead of duplicating the HTTP on-the-wire representation here.,not
mitmproxy/pathod/language/http.py,12,see http2 language for an example,not
mitmproxy/pathod/language/http.py,129,pragma: no cover,not
mitmproxy/pathod/language/http.py,148,type: ignore,not
mitmproxy/pathod/language/http2.py,58,self.toks(actions._Action),not
mitmproxy/pathod/language/actions.py,9,type: ignore,not
mitmproxy/pathod/language/actions.py,44,pragma: no cover,not
mitmproxy/pathod/language/actions.py,48,pragma: no cover,not
mitmproxy/pathod/language/actions.py,104,type: ignore,not
mitmproxy/pathod/language/websockets.py,3,noqa,not
mitmproxy/pathod/language/websockets.py,82,Bit flags,not
mitmproxy/pathod/language/websockets.py,102,Used for nested frames,not
mitmproxy/pathod/language/__init__.py,37,"http2.Frame.expr(),",not
mitmproxy/pathod/language/__init__.py,59,"http2.Frame.expr(),",not
mitmproxy/mitmproxy/optmanager.py,97,"Options must be the last attribute here - after that, we raise an",not
mitmproxy/mitmproxy/optmanager.py,98,error for attribute assigment to unknown options.,not
mitmproxy/mitmproxy/optmanager.py,118,Notify error handlers,not
mitmproxy/mitmproxy/optmanager.py,120,Rollback,not
mitmproxy/mitmproxy/optmanager.py,138,We reuse blinker's safe reference functionality to cope with weakrefs,not
mitmproxy/mitmproxy/optmanager.py,139,to bound methods.,not
mitmproxy/mitmproxy/optmanager.py,151,"Our wrapper function goes out of scope immediately, so we have to set",not
mitmproxy/mitmproxy/optmanager.py,152,"weakrefs to false. This means we need to keep our own weakref, and",not
mitmproxy/mitmproxy/optmanager.py,153,clean up the hook when it's gone.,not
mitmproxy/mitmproxy/optmanager.py,175,This is slightly tricky. We allow attributes to be set on the instance,not
mitmproxy/mitmproxy/optmanager.py,176,"until we have an _options attribute. After that, assignment is sent to",not
mitmproxy/mitmproxy/optmanager.py,177,"the update function, and will raise an error for unknown options.",not
mitmproxy/mitmproxy/optmanager.py,386,The short option for a bool goes to whatever is NOT the default,not
mitmproxy/mitmproxy/optmanager.py,441,Sort data,not
mitmproxy/mitmproxy/options.py,27,Proxy options,not
mitmproxy/mitmproxy/controller.py,48,"special object we can distinguish from a valid ""None"" reply.",not
mitmproxy/mitmproxy/controller.py,58,Spawn an event loop in the current thread,not
mitmproxy/mitmproxy/controller.py,61,"""start"" -> ""taken"" -> ""committed""",not
mitmproxy/mitmproxy/controller.py,63,Holds the reply value. May change before things are actually committed.,not
mitmproxy/mitmproxy/controller.py,130,"This will be ignored by the interpreter, but emit a warning",not
mitmproxy/mitmproxy/websocket.py,22,type: ignore,not
mitmproxy/mitmproxy/websocket.py,42,replace enum with bare int,not
mitmproxy/mitmproxy/websocket.py,103,mypy doesn't support update with kwargs,not
mitmproxy/mitmproxy/websocket.py,116,"Do not include handshake_flow, to prevent recursive serialization!",not
mitmproxy/mitmproxy/websocket.py,117,"Since mitmproxy-console currently only displays HTTPFlows,",not
mitmproxy/mitmproxy/websocket.py,118,dumping the handshake_flow will include the WebSocketFlow too.,not
mitmproxy/mitmproxy/websocket.py,123,replace enum with bare int,not
mitmproxy/mitmproxy/master.py,21,Conclusively preventing cross-thread races on proxy shutdown turns out to be,not
mitmproxy/mitmproxy/master.py,22,"very hard. We could build a thread sync infrastructure for this, or we could",not
mitmproxy/mitmproxy/master.py,23,wait until we ditch threads and move all the protocols into the async loop.,not
mitmproxy/mitmproxy/master.py,24,"Until then, silence non-critical errors.",not
mitmproxy/mitmproxy/master.py,87,pragma: no cover,not
mitmproxy/mitmproxy/master.py,90,pragma: no cover,not
mitmproxy/mitmproxy/master.py,98,pragma: no cover,not
mitmproxy/mitmproxy/master.py,124,"Weird band-aid to make sure that self._shutdown() is actually executed,",not
mitmproxy/mitmproxy/master.py,125,which otherwise hangs the process as the proxy server is threaded.,not
mitmproxy/mitmproxy/master.py,126,This all needs to be simplified when the proxy server runs on asyncio as well.,not
mitmproxy/mitmproxy/master.py,127,pragma: no cover,not
mitmproxy/mitmproxy/master.py,131,Event loop stopped before Future completed.,not
mitmproxy/mitmproxy/eventsequence.py,14,TCP,not
mitmproxy/mitmproxy/eventsequence.py,19,HTTP,not
mitmproxy/mitmproxy/eventsequence.py,26,WebSocket,not
mitmproxy/mitmproxy/eventsequence.py,32,misc,not
mitmproxy/mitmproxy/addonmanager.py,203,pragma: no cover,not
mitmproxy/mitmproxy/addonmanager.py,208,We can use DummyReply objects multiple times. We only clear them up on,not
mitmproxy/mitmproxy/addonmanager.py,209,the next handler so that we can access value and state in the,not
mitmproxy/mitmproxy/addonmanager.py,210,meantime.,not
mitmproxy/mitmproxy/addonmanager.py,240,we gracefully exclude module imports with the same name as hooks.,not
mitmproxy/mitmproxy/addonmanager.py,241,"For example, a user may have ""from mitmproxy import log"" in an addon,",not
mitmproxy/mitmproxy/addonmanager.py,242,"which has the same name as the ""log"" hook. In this particular case,",not
mitmproxy/mitmproxy/addonmanager.py,243,"we end up in an error loop because we ""log"" this error.",not
mitmproxy/mitmproxy/command_lexer.py,6,TODO: There is a lot of work to be done here.,SATD
mitmproxy/mitmproxy/command_lexer.py,7,"The current implementation is written in a way that _any_ input is valid,",not
mitmproxy/mitmproxy/command_lexer.py,8,which does not make sense once things get more complex.,not
mitmproxy/mitmproxy/command_lexer.py,35,TODO: More of a hack.,SATD
mitmproxy/mitmproxy/http.py,15,This is a very thin wrapper on top of :py:class:`mitmproxy.net.http.Request` and,not
mitmproxy/mitmproxy/http.py,16,may be removed in the future.,not
mitmproxy/mitmproxy/http.py,47,Is this request replayed?,not
mitmproxy/mitmproxy/http.py,90,This is a very thin wrapper on top of :py:class:`mitmproxy.net.http.Response` and,not
mitmproxy/mitmproxy/http.py,91,may be removed in the future.,not
mitmproxy/mitmproxy/http.py,115,Is this request replayed?,not
mitmproxy/mitmproxy/http.py,161,mypy doesn't support update with kwargs,not
mitmproxy/mitmproxy/http.py,249,Do not send any response headers as it breaks proxying non-80 ports on,not
mitmproxy/mitmproxy/http.py,250,Android emulators using the -http-proxy option.,not
mitmproxy/mitmproxy/certs.py,17,Default expiry must not be too long: https://github.com/mitmproxy/mitmproxy/issues/815,not
mitmproxy/mitmproxy/certs.py,18,= 60 * 60 * 24 * 365 * 3 = 3 years,not
mitmproxy/mitmproxy/certs.py,19,= 60 * 60 * 24 * 365 = 1 year,not
mitmproxy/mitmproxy/certs.py,21,"Generated with ""openssl dhparam"". It's too slow to generate this on startup.",not
mitmproxy/mitmproxy/certs.py,138,manually provided certs (e.g. mitmproxy's --certs),not
mitmproxy/mitmproxy/certs.py,139,"(common_name, sans)",not
mitmproxy/mitmproxy/certs.py,174,mitmproxy<=0.10 doesn't generate a dhparam file.,not
mitmproxy/mitmproxy/certs.py,175,Create it now if necessary.,not
mitmproxy/mitmproxy/certs.py,233,Dump the CA plus private key,not
mitmproxy/mitmproxy/certs.py,244,Dump the certificate in PEM format,not
mitmproxy/mitmproxy/certs.py,251,Create a .cer file with the same contents for Android,not
mitmproxy/mitmproxy/certs.py,258,Dump the certificate in PKCS12 format for Windows devices,not
mitmproxy/mitmproxy/certs.py,264,Dump the certificate and key in a PKCS12 format for Windows devices,not
mitmproxy/mitmproxy/certs.py,366,We only care about dNSName and iPAddress,not
mitmproxy/mitmproxy/certs.py,482,tcp.TCPClient.convert_to_tls assumes that this property only contains DNS altnames for hostname verification.,not
mitmproxy/mitmproxy/flowfilter.py,340,"FUrl is special, because it can be ""naked"".",not
mitmproxy/mitmproxy/flowfilter.py,470,Order is important - multi-char expressions need to come before narrow,not
mitmproxy/mitmproxy/flowfilter.py,471,ones.,not
mitmproxy/mitmproxy/flowfilter.py,478,"This is a bit of a hack to simulate Word(pyparsing_unicode.printables),",SATD
mitmproxy/mitmproxy/flowfilter.py,479,which has a horrible performance with len(pyparsing.pyparsing_unicode.printables) == 1114060,not
mitmproxy/mitmproxy/flowfilter.py,497,A naked rex is a URL rex:,not
mitmproxy/mitmproxy/types.py,8,pragma: no cover,not
mitmproxy/mitmproxy/types.py,44,pragma: no cover,not
mitmproxy/mitmproxy/types.py,45,"return false here so that arguments are piped through parsearg,",not
mitmproxy/mitmproxy/types.py,46,which does extended validation.,not
mitmproxy/mitmproxy/types.py,368,pragma: no cover,not
mitmproxy/mitmproxy/types.py,373,pragma: no cover,not
mitmproxy/mitmproxy/types.py,377,"FIXME: validate that all rows have equal length, and all columns have equal types",SATD
mitmproxy/mitmproxy/connections.py,35,"Eventually, this object is restored from state. We don't have a",not
mitmproxy/mitmproxy/connections.py,36,connection then.,not
mitmproxy/mitmproxy/connections.py,136,"Unfortunately OpenSSL provides no way to expose all TLS extensions, so we do this dance",not
mitmproxy/mitmproxy/connections.py,137,here and use our Kaitai parser.,not
mitmproxy/mitmproxy/connections.py,140,pragma: no cover,not
mitmproxy/mitmproxy/connections.py,141,"if this fails, we don't want everything to go down.",not
mitmproxy/mitmproxy/exceptions.py,52,"In contrast to most others, this is a user-facing error which needs to look good.",not
mitmproxy/mitmproxy/__init__.py,5,workaround for,SATD
mitmproxy/mitmproxy/__init__.py,6,https://github.com/tornadoweb/tornado/issues/2751,not
mitmproxy/mitmproxy/__init__.py,7,https://www.tornadoweb.org/en/stable/index.html#installation,not
mitmproxy/mitmproxy/command.py,28,type: ignore,not
mitmproxy/mitmproxy/command.py,72,This fails with a CommandException if types are invalid,not
mitmproxy/mitmproxy/command.py,152,"hasattr is not enough, see https://github.com/mitmproxy/mitmproxy/issues/3794",not
mitmproxy/mitmproxy/command.py,155,getattr may raise if o implements __getattr__.,not
mitmproxy/mitmproxy/version.py,9,"Serialization format version. This is displayed nowhere, it just needs to be incremented by one",not
mitmproxy/mitmproxy/version.py,10,for each change in the file format.,not
mitmproxy/mitmproxy/version.py,34,Add commit info for non-tagged releases,not
mitmproxy/mitmproxy/version.py,38,"PyInstaller build indicator, if using precompiled binary",not
mitmproxy/mitmproxy/version.py,45,pragma: no cover,not
mitmproxy/mitmproxy/stateobject.py,79,"This requires a bit of explanation. We can't import our IO layer here,",not
mitmproxy/mitmproxy/stateobject.py,80,because it causes a circular import. Rather than restructuring the,not
mitmproxy/mitmproxy/stateobject.py,81,"code for this, we use JSON serialization, which has similar primitive",not
mitmproxy/mitmproxy/stateobject.py,82,"type restrictions as tnetstring, to check for conformance.",not
mitmproxy/mitmproxy/flow.py,2,noqa,not
mitmproxy/mitmproxy/flow.py,6,noqa,not
mitmproxy/mitmproxy/flow.py,48,the default implementation assumes an empty constructor. Override,not
mitmproxy/mitmproxy/flow.py,49,accordingly.,not
mitmproxy/mitmproxy/flow.py,179,"If a flow is intercepted and then duplicated, the duplicated one is not taken.",not
mitmproxy/mitmproxy/utils/human.py,63,less than 1 sec,not
mitmproxy/mitmproxy/utils/human.py,91,If IPv6 is mapped to IPv4,not
mitmproxy/mitmproxy/utils/strutils.py,31,"Translate control characters to ""safe"" characters. This implementation",not
mitmproxy/mitmproxy/utils/strutils.py,32,initially replaced them with the matching control pictures,not
mitmproxy/mitmproxy/utils/strutils.py,33,"(http://unicode.org/charts/PDF/U2400.pdf), but that turned out to render badly",not
mitmproxy/mitmproxy/utils/strutils.py,34,"with monospace fonts. We are back to ""."" therefore.",not
mitmproxy/mitmproxy/utils/strutils.py,36,x + 0x2400 for unicode control group pictures,not
mitmproxy/mitmproxy/utils/strutils.py,39,0x2421,not
mitmproxy/mitmproxy/utils/strutils.py,76,We always insert a double-quote here so that we get a single-quoted string back,not
mitmproxy/mitmproxy/utils/strutils.py,77,https://stackoverflow.com/questions/29019340/why-does-python-use-different-quotes-for-representing-strings-depending-on-their,not
mitmproxy/mitmproxy/utils/strutils.py,100,This one is difficult - we use an undocumented Python API here,not
mitmproxy/mitmproxy/utils/strutils.py,101,as per http://stackoverflow.com/a/23151714/934719,not
mitmproxy/mitmproxy/utils/strutils.py,140,16*2 + 15,not
mitmproxy/mitmproxy/utils/sliding_window.py,20,TODO: move into utils,SATD
mitmproxy/mitmproxy/utils/typecheck.py,4,anything more elaborate really fails with mypy at the moment.,not
mitmproxy/mitmproxy/utils/typecheck.py,10,type: ignore,not
mitmproxy/mitmproxy/utils/typecheck.py,15,type: ignore,not
mitmproxy/mitmproxy/utils/typecheck.py,20,type: ignore,not
mitmproxy/mitmproxy/utils/typecheck.py,25,type: ignore,not
mitmproxy/mitmproxy/utils/debug.py,26,pragma: no cover,not
mitmproxy/mitmproxy/utils/debug.py,100,pragma: no cover,not
mitmproxy/mitmproxy/utils/debug.py,105,pragma: windows no cover,not
mitmproxy/mitmproxy/proxy/server.py,6,noqa,not
mitmproxy/mitmproxy/proxy/server.py,109,pragma: no cover,not
mitmproxy/mitmproxy/proxy/server.py,111,pragma: no cover,not
mitmproxy/mitmproxy/proxy/server.py,139,"If an error propagates to the topmost level,",not
mitmproxy/mitmproxy/proxy/server.py,140,"we send an HTTP error response, which is both",not
mitmproxy/mitmproxy/proxy/server.py,141,understandable by HTTP clients and humans.,not
mitmproxy/mitmproxy/proxy/root_context.py,51,1. check for filter,not
mitmproxy/mitmproxy/proxy/root_context.py,65,"2. Always insert a TLS layer, even if there's neither client nor server tls.",not
mitmproxy/mitmproxy/proxy/root_context.py,66,"An inline script may upgrade from http to https,",not
mitmproxy/mitmproxy/proxy/root_context.py,67,in which case we need some form of TLS layer.,not
mitmproxy/mitmproxy/proxy/root_context.py,78,"if the user manually sets a scheme for connect requests, we use this to decide if we",not
mitmproxy/mitmproxy/proxy/root_context.py,79,want TLS or not.,not
mitmproxy/mitmproxy/proxy/root_context.py,86,"3. In Http Proxy mode and Upstream Proxy mode, the next layer is fixed.",not
mitmproxy/mitmproxy/proxy/root_context.py,93,4. Check for other TLS cases (e.g. after CONNECT).,not
mitmproxy/mitmproxy/proxy/root_context.py,97,4. Check for --tcp,not
mitmproxy/mitmproxy/proxy/root_context.py,101,5. Check for TLS ALPN (HTTP1/HTTP2),not
mitmproxy/mitmproxy/proxy/root_context.py,109,6. Check for raw tcp mode,not
mitmproxy/mitmproxy/proxy/root_context.py,112,expect A-Za-z,not
mitmproxy/mitmproxy/proxy/root_context.py,118,7. Assume HTTP1 by default,not
mitmproxy/mitmproxy/proxy/config.py,25,"self.handle == ""allow""",not
mitmproxy/mitmproxy/proxy/protocol/base.py,3,noqa,not
mitmproxy/mitmproxy/proxy/protocol/base.py,4,noqa,not
mitmproxy/mitmproxy/proxy/protocol/base.py,13,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/websocket.py,91,fail-safe for unhandled events,not
mitmproxy/mitmproxy/proxy/protocol/websocket.py,92,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/websocket.py,118,"message has the same length, we can reuse the same sizes",not
mitmproxy/mitmproxy/proxy/protocol/websocket.py,124,just re-chunk everything into 4kB frames,not
mitmproxy/mitmproxy/proxy/protocol/websocket.py,125,header len = 4 bytes without masking key and 8 bytes with masking key,not
mitmproxy/mitmproxy/proxy/protocol/websocket.py,141,Use event.response to create the approprate Pong response,not
mitmproxy/mitmproxy/proxy/protocol/http.py,7,noqa,not
mitmproxy/mitmproxy/proxy/protocol/http.py,31,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http.py,106,swallow the message,not
mitmproxy/mitmproxy/proxy/protocol/http.py,131,"At this point, we see only a subset of the proxy modes",not
mitmproxy/mitmproxy/proxy/protocol/http.py,164,mypy type hints,not
mitmproxy/mitmproxy/proxy/protocol/http.py,173,"We cannot rely on server_conn.tls_established,",not
mitmproxy/mitmproxy/proxy/protocol/http.py,174,see https://github.com/mitmproxy/mitmproxy/issues/925,not
mitmproxy/mitmproxy/proxy/protocol/http.py,176,Requests happening after CONNECT do not need Proxy-Authorization headers.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,212,HTTPS tasting means that ordinary errors like resolution,not
mitmproxy/mitmproxy/proxy/protocol/http.py,213,and connection errors can happen here.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,222,"if the user specifies a response in the http_connect hook, we do not connect upstream here.",not
mitmproxy/mitmproxy/proxy/protocol/http.py,223,https://github.com/mitmproxy/mitmproxy/pull/2473,not
mitmproxy/mitmproxy/proxy/protocol/http.py,246,don't throw an error for disconnects that happen,not
mitmproxy/mitmproxy/proxy/protocol/http.py,247,before/between requests.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,253,The standards are silent on what we should do with a CONNECT,not
mitmproxy/mitmproxy/proxy/protocol/http.py,254,"request body, so although it's not common, it's allowed.",not
mitmproxy/mitmproxy/proxy/protocol/http.py,272,Re-validate request form in case the user has changed something.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,276,TODO: We may have to use send_response_headers for HTTP2,SATD
mitmproxy/mitmproxy/proxy/protocol/http.py,277,here.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,287,We optimistically guess there might be an HTTP client on the,not
mitmproxy/mitmproxy/proxy/protocol/http.py,288,other end,not
mitmproxy/mitmproxy/proxy/protocol/http.py,290,"Request may be malformed at this point, so we unset it.",not
mitmproxy/mitmproxy/proxy/protocol/http.py,303,"set first line format to relative in regular mode,",not
mitmproxy/mitmproxy/proxy/protocol/http.py,304,see https://github.com/mitmproxy/mitmproxy/issues/1759,not
mitmproxy/mitmproxy/proxy/protocol/http.py,308,update host header in reverse proxy mode,not
mitmproxy/mitmproxy/proxy/protocol/http.py,312,"Determine .scheme, .host and .port attributes for inline scripts. For",not
mitmproxy/mitmproxy/proxy/protocol/http.py,313,"absolute-form requests, they are directly given in the request. For",not
mitmproxy/mitmproxy/proxy/protocol/http.py,314,"authority-form requests, we only need to determine the request",not
mitmproxy/mitmproxy/proxy/protocol/http.py,315,"scheme. For relative-form requests, we need to determine host and",not
mitmproxy/mitmproxy/proxy/protocol/http.py,316,port as well.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,318,"Setting request.host also updates the host header, which we want",not
mitmproxy/mitmproxy/proxy/protocol/http.py,319,to preserve,not
mitmproxy/mitmproxy/proxy/protocol/http.py,323,set again as .host overwrites this.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,330,We only support RFC6455 with WebSocket version 13,not
mitmproxy/mitmproxy/proxy/protocol/http.py,331,allow inline scripts to manipulate the client handshake,not
mitmproxy/mitmproxy/proxy/protocol/http.py,360,"In any case, we try to reconnect at least once. This is",not
mitmproxy/mitmproxy/proxy/protocol/http.py,361,necessary because it might be possible that we already,not
mitmproxy/mitmproxy/proxy/protocol/http.py,362,initiated an upstream connection after clientconnect that,not
mitmproxy/mitmproxy/proxy/protocol/http.py,363,"has already been expired, e.g consider the following event",not
mitmproxy/mitmproxy/proxy/protocol/http.py,364,log:,not
mitmproxy/mitmproxy/proxy/protocol/http.py,365,> clientconnect (transparent mode destination known),not
mitmproxy/mitmproxy/proxy/protocol/http.py,366,> serverconnect (required for client tls handshake),not
mitmproxy/mitmproxy/proxy/protocol/http.py,367,> read n% of large request,not
mitmproxy/mitmproxy/proxy/protocol/http.py,368,"> server detects timeout, disconnects",not
mitmproxy/mitmproxy/proxy/protocol/http.py,369,> read (100-n)% of large request,not
mitmproxy/mitmproxy/proxy/protocol/http.py,370,> send large request upstream,not
mitmproxy/mitmproxy/proxy/protocol/http.py,373,do not try to reconnect for HTTP2,not
mitmproxy/mitmproxy/proxy/protocol/http.py,378,"We may have already consumed some request chunks already,",not
mitmproxy/mitmproxy/proxy/protocol/http.py,379,so all we can do is signal downstream that upstream closed the connection.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,389,call the appropriate script hook - this is an opportunity for,not
mitmproxy/mitmproxy/proxy/protocol/http.py,390,an inline script to set f.stream = True,not
mitmproxy/mitmproxy/proxy/protocol/http.py,401,no further manipulation of self.server_conn beyond this point,not
mitmproxy/mitmproxy/proxy/protocol/http.py,402,we can safely set it as the final attribute value here.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,405,response was set by an inline script.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,406,we now need to emulate the responseheaders hook.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,413,no streaming:,not
mitmproxy/mitmproxy/proxy/protocol/http.py,414,we already received the full response from the server and can,not
mitmproxy/mitmproxy/proxy/protocol/http.py,415,send it to the client straight away.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,418,streaming:,not
mitmproxy/mitmproxy/proxy/protocol/http.py,419,First send the headers and then transfer the response incrementally,not
mitmproxy/mitmproxy/proxy/protocol/http.py,433,Handle 101 Switching Protocols,not
mitmproxy/mitmproxy/proxy/protocol/http.py,435,"Handle a successful HTTP 101 Switching Protocols Response,",not
mitmproxy/mitmproxy/proxy/protocol/http.py,436,received after e.g. a WebSocket upgrade request.,not
mitmproxy/mitmproxy/proxy/protocol/http.py,437,Check for WebSocket handshake,not
mitmproxy/mitmproxy/proxy/protocol/http.py,453,should never be reached,not
mitmproxy/mitmproxy/proxy/protocol/http.py,479,"Make set_upstream_proxy_server always available,",not
mitmproxy/mitmproxy/proxy/protocol/http.py,480,even if there's no UpstreamConnectLayer,not
mitmproxy/mitmproxy/proxy/protocol/http.py,491,"If there's an existing connection that doesn't match our expectations, kill it.",not
mitmproxy/mitmproxy/proxy/protocol/http.py,496,Establish connection is necessary.,not
mitmproxy/mitmproxy/proxy/protocol/http1.py,74,Workaround for https://github.com/mitmproxy/mitmproxy/issues/313:,SATD
mitmproxy/mitmproxy/proxy/protocol/http1.py,75,Charles Proxy sends a CONNECT response with HTTP/1.0,not
mitmproxy/mitmproxy/proxy/protocol/http1.py,76,and no Content-Length header,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,4,noqa,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,11,noqa,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,42,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,43,stream is already closed - good,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,66,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,73,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,87,mypy type hints,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,135,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,136,WebSocket over HTTP/2?,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,137,CONNECT for proxying?,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,175,fail-safe for unhandled events,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,213,always acknowledge receved data with a WINDOW_UPDATE frame,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,249,Something terrible has happened - kill everything!,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,265,pushed stream ids should be unique and not dependent on race conditions,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,266,only the parent stream id must be looked up first,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,291,this event was already handled during stream creation,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,292,HeadersFrame + Priority information as RequestReceived,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,298,"if the stream is already up and running and was sent to the server,",not
mitmproxy/mitmproxy/proxy/protocol/http2.py,299,use the mapped server stream id to update priority information,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,319,if the depends-on-stream is already up and running and was sent to the server,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,320,use the mapped server stream id to update priority information,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,323,looks like one of the streams wasn't opened yet,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,324,prevent self-dependent streams which result in ProtocolError,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,334,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,359,read frame failed: connection closed,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,372,connection terminated: GoAway,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,377,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,382,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,435,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,438,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,441,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,445,This layer only handles a single stream.,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,446,RFC 7540 8.1: An HTTP request/response exchange fully consumes a single stream.,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,474,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,512,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,524,nothing to do here,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,533,wait until we get a free slot for a new outgoing stream,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,538,keep the lock,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,541,We must not assign a stream id if we are already a zombie.,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,556,only send priority information if they actually came with the original HeadersFrame,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,557,and not if they got updated before/after with a PriorityFrame,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,575,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,584,nothing to do here,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,624,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,652,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,660,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,661,zombies can be safely terminated - no need to kill them twice,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,663,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,665,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/http2.py,667,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/rawtcp.py,32,https://github.com/openssl/openssl/issues/6234,not
mitmproxy/mitmproxy/proxy/protocol/rawtcp.py,48,Shutdown connection to the other peer,not
mitmproxy/mitmproxy/proxy/protocol/rawtcp.py,50,"We can't half-close a connection, so we just close everything here.",not
mitmproxy/mitmproxy/proxy/protocol/rawtcp.py,51,Sockets will be cleaned up on a higher level.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,1,noqa,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,8,taken from https://testssl.sh/openssl-rfc.mapping.html,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,38,"0x1c: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,39,"0x1d: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,104,"0x8e: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,105,"0x8f: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,106,"0x90: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,107,"0x91: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,108,"0x92: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,109,"0x93: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,110,"0x94: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,111,"0x95: ,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,198,"We manually need to specify this, otherwise OpenSSL may select a non-HTTP2 cipher by default.",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,199,https://ssl-config.mozilla.org/#config=old,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,240,"Peek into the connection, read the initial client hello and parse it to obtain SNI and ALPN values.",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,245,Without knowning the ClientHello we cannot proceed in this connection.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,248,Do we need to do a server handshake now?,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,249,There are two reasons why we would want to establish TLS with the server now:,SATD
mitmproxy/mitmproxy/proxy/protocol/tls.py,250,"1. If we already have an existing server connection and server_tls is True,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,251,we need to establish TLS now because .connect() will not be called anymore.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,252,2. We may need information from the server connection for the client handshake.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,253,,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,254,A couple of factors influence (2):,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,255,2.1 There actually is (or will be) a TLS-enabled upstream connection,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,256,2.2 An upstream connection is not wanted by the user if --no-upstream-cert is passed.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,257,2.3 An upstream connection is implied by add_upstream_certs_to_client_chain,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,258,"2.4 The client wants to negotiate an alternative protocol in its handshake, we need to find out",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,259,what is supported by the server,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,260,"2.5 The client did not sent a SNI value, we don't know the certificate subject.",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,287,pragma: no cover,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,343,This gets triggered if we haven't established an upstream connection yet.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,360,"If establishing TLS with the server fails, we try to establish TLS with the client nonetheless",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,361,to send an error message over TLS.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,391,"Some TLS clients will not fail the handshake,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,392,"but will immediately throw an ""unexpected eof"" error on the first read.",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,393,"The reason for this might be difficult to find, so we try to peek here to see if it",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,394,raises ann error.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,411,We only support http/1.1 and h2.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,412,"If the server only supports spdy (next to http/1.1), it may select that",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,413,"and mitmproxy would enter TCP passthrough mode, which we want to avoid.",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,422,"If the client has already negotiated an ALP, then force the",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,423,server to use the same. This can only happen if the host gets,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,424,changed after the initial connection was established. E.g.:,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,425,"* the client offers http/1.1 and h2,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,426,"* the initial host is only capable of http/1.1,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,427,"* then the first server connection negotiates http/1.1,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,428,"* but after the server_conn change, the new host offers h2",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,429,* which results in garbage because the layers don' match.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,432,"We pass through the list of ciphers send by the client, because some HTTP/2 servers",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,433,will select a non-HTTP/2 compatible cipher from our default list and then hang up,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,434,because it's incompatible with h2. :-),not
mitmproxy/mitmproxy/proxy/protocol/tls.py,478,"In normal operation, the server address should always be known at this point.",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,479,"However, we may just want to establish TLS so that we can send an error message to the client,",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,480,in which case the address can be None.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,484,Should we incorporate information from the server certificate?,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,498,Also add SNI values.,not
mitmproxy/mitmproxy/proxy/protocol/tls.py,504,"RFC 2818: If a subjectAltName extension of type dNSName is present, that MUST be used as the identity.",not
mitmproxy/mitmproxy/proxy/protocol/tls.py,505,"In other words, the Common Name is irrelevant then.",not
mitmproxy/mitmproxy/proxy/modes/socks_proxy.py,10,Parse Client Greeting,not
mitmproxy/mitmproxy/proxy/modes/socks_proxy.py,19,Send Server Greeting,not
mitmproxy/mitmproxy/proxy/modes/socks_proxy.py,27,Parse Connect Request,not
mitmproxy/mitmproxy/proxy/modes/socks_proxy.py,36,"We always connect lazily, but we need to pretend to the client that we connected.",not
mitmproxy/mitmproxy/proxy/modes/socks_proxy.py,41,"dummy value, we don't have an upstream connection yet.",not
mitmproxy/mitmproxy/platform/windows.py,24,,not
mitmproxy/mitmproxy/platform/windows.py,25,Resolver,not
mitmproxy/mitmproxy/platform/windows.py,106,,not
mitmproxy/mitmproxy/platform/windows.py,107,Windows API,not
mitmproxy/mitmproxy/platform/windows.py,109,from Windows' error.h,not
mitmproxy/mitmproxy/platform/windows.py,116,,not
mitmproxy/mitmproxy/platform/windows.py,117,IPv6,not
mitmproxy/mitmproxy/platform/windows.py,118,,not
mitmproxy/mitmproxy/platform/windows.py,120,https://msdn.microsoft.com/en-us/library/windows/desktop/aa366896(v=vs.85).aspx,not
mitmproxy/mitmproxy/platform/windows.py,134,https://msdn.microsoft.com/en-us/library/windows/desktop/aa366905(v=vs.85).aspx,not
mitmproxy/mitmproxy/platform/windows.py,145,,not
mitmproxy/mitmproxy/platform/windows.py,146,IPv4,not
mitmproxy/mitmproxy/platform/windows.py,147,,not
mitmproxy/mitmproxy/platform/windows.py,149,https://msdn.microsoft.com/en-us/library/windows/desktop/aa366913(v=vs.85).aspx,not
mitmproxy/mitmproxy/platform/windows.py,161,https://msdn.microsoft.com/en-us/library/windows/desktop/aa366921(v=vs.85).aspx,not
mitmproxy/mitmproxy/platform/windows.py,215,"no need to update size, that's already done.",not
mitmproxy/mitmproxy/platform/windows.py,236,"no need to update size, that's already done.",not
mitmproxy/mitmproxy/platform/windows.py,243,Auto-Detect local IP. This is required as re-injecting to 127.0.0.1 does not work.,not
mitmproxy/mitmproxy/platform/windows.py,244,https://stackoverflow.com/questions/166506/finding-local-ip-addresses-using-pythons-stdlib,not
mitmproxy/mitmproxy/platform/windows.py,256,"The same goes for IPv6, with the added difficulty that .connect() fails if",not
mitmproxy/mitmproxy/platform/windows.py,257,the target network is not reachable.,not
mitmproxy/mitmproxy/platform/windows.py,335,"If this fails, we most likely have a connection from an external client.",not
mitmproxy/mitmproxy/platform/windows.py,336,"In this, case we always want to proxy the request.",not
mitmproxy/mitmproxy/platform/windows.py,342,"It's not really clear why we need to recalculate the checksum here,",not
mitmproxy/mitmproxy/platform/windows.py,343,but this was identified as necessary in https://github.com/mitmproxy/mitmproxy/pull/3174.,not
mitmproxy/mitmproxy/platform/windows.py,411,really weird linting error here.,not
mitmproxy/mitmproxy/platform/windows.py,412,noqa,not
mitmproxy/mitmproxy/platform/windows.py,437,"print(f""IPv4: {self.ipv4_address}, IPv6: {self.ipv6_address}"")",not
mitmproxy/mitmproxy/platform/windows.py,456,"The proxy server responds to the client. To the client,",not
mitmproxy/mitmproxy/platform/windows.py,457,this response should look like it has been sent by the real target,not
mitmproxy/mitmproxy/platform/windows.py,463,Block all ICMP requests (which are sent on Windows by default).,not
mitmproxy/mitmproxy/platform/windows.py,464,"If we don't do this, our proxy machine may send an ICMP redirect to the client,",not
mitmproxy/mitmproxy/platform/windows.py,465,which instructs the client to directly connect to the real gateway,not
mitmproxy/mitmproxy/platform/windows.py,466,if they are on the same network.,not
mitmproxy/mitmproxy/platform/windows.py,475,TODO: Make sure that server can be killed cleanly. That's a bit difficult as we don't have access to,SATD
mitmproxy/mitmproxy/platform/windows.py,476,controller.should_exit when this is called.,not
mitmproxy/mitmproxy/platform/windows.py,502,"print("" * Redirect client -> server to proxy"")",not
mitmproxy/mitmproxy/platform/windows.py,503,"print(f""{packet.src_addr}:{packet.src_port} -> {packet.dst_addr}:{packet.dst_port}"")",not
mitmproxy/mitmproxy/platform/windows.py,508,"We do need to inject to an external IP here, 127.0.0.1 does not work.",not
mitmproxy/mitmproxy/platform/windows.py,522,"We need a handle on the NETWORK layer. the local handle is not guaranteed to exist,",not
mitmproxy/mitmproxy/platform/windows.py,523,so we use the response handle.,not
mitmproxy/mitmproxy/platform/windows.py,531,"print("" * Adjust proxy -> client"")",not
mitmproxy/mitmproxy/platform/linux.py,5,Python's socket module does not have these constants,not
mitmproxy/mitmproxy/platform/linux.py,11,Get the original destination on Linux.,not
mitmproxy/mitmproxy/platform/linux.py,12,"In theory, this can be done using the following syscalls:",not
mitmproxy/mitmproxy/platform/linux.py,13,"sock.getsockopt(socket.SOL_IP, SO_ORIGINAL_DST, 16)",not
mitmproxy/mitmproxy/platform/linux.py,14,"sock.getsockopt(SOL_IPV6, SO_ORIGINAL_DST, 28)",not
mitmproxy/mitmproxy/platform/linux.py,15,,not
mitmproxy/mitmproxy/platform/linux.py,16,"In practice, it is a bit more complex:",not
mitmproxy/mitmproxy/platform/linux.py,17,1. We cannot rely on sock.family to decide which syscall to use because of IPv4-mapped,not
mitmproxy/mitmproxy/platform/linux.py,18,"IPv6 addresses. If sock.family is AF_INET6 while sock.getsockname() is ::ffff:127.0.0.1,",not
mitmproxy/mitmproxy/platform/linux.py,19,we need to call the IPv4 version to get a result.,not
mitmproxy/mitmproxy/platform/linux.py,20,"2. We can't just try the IPv4 syscall and then do IPv6 if that doesn't work,",not
mitmproxy/mitmproxy/platform/linux.py,21,because doing the wrong syscall can apparently crash the whole Python runtime.,not
mitmproxy/mitmproxy/platform/linux.py,22,"As such, we use a heuristic to check which syscall to do.",not
mitmproxy/mitmproxy/platform/linux.py,23,either 127.0.0.1 or ::ffff:127.0.0.1,not
mitmproxy/mitmproxy/platform/linux.py,25,"the struct returned here should only have 8 bytes, but invoking sock.getsockopt",not
mitmproxy/mitmproxy/platform/linux.py,26,with buflen=8 doesn't work.,not
mitmproxy/mitmproxy/platform/__init__.py,35,noqa,not
mitmproxy/mitmproxy/platform/pf.py,12,"We may get an ipv4-mapped ipv6 address here, e.g. ::ffff:127.0.0.1.",not
mitmproxy/mitmproxy/platform/pf.py,13,"Those still appear as ""127.0.0.1"" in the table, so we need to strip the prefix.",not
mitmproxy/mitmproxy/platform/pf.py,17,ALL tcp 192.168.1.13:57474 -> 23.205.82.58:443       ESTABLISHED:ESTABLISHED,not
mitmproxy/mitmproxy/platform/pf.py,20,ALL tcp 2a01:e35:8bae:50f0:9d9b:ef0d:2de3:b733[58505] -> 2606:4700:30::681f:4ad0[443]       ESTABLISHED:ESTABLISHED,not
mitmproxy/mitmproxy/platform/pf.py,28,strip parentheses for FreeBSD pfctl,not
mitmproxy/mitmproxy/net/tcp.py,10,noqa,not
mitmproxy/mitmproxy/net/tcp.py,22,workaround for https://bugs.python.org/issue29515,SATD
mitmproxy/mitmproxy/net/tcp.py,23,Python 3.6 for Windows is missing a constant,not
mitmproxy/mitmproxy/net/tcp.py,120,TLS connection was shut down cleanly,not
mitmproxy/mitmproxy/net/tcp.py,123,From the OpenSSL docs:,not
mitmproxy/mitmproxy/net/tcp.py,124,"If the underlying BIO is non-blocking, SSL_read() will also return when the",not
mitmproxy/mitmproxy/net/tcp.py,125,underlying BIO could not satisfy the needs of SSL_read() to continue the,not
mitmproxy/mitmproxy/net/tcp.py,126,operation. In this case a call to SSL_get_error with the return value of,not
mitmproxy/mitmproxy/net/tcp.py,127,SSL_read() will yield SSL_ERROR_WANT_READ or SSL_ERROR_WANT_WRITE.,not
mitmproxy/mitmproxy/net/tcp.py,235,We already indicate that we close our end.,not
mitmproxy/mitmproxy/net/tcp.py,236,"may raise ""Transport endpoint is not connected"" on Linux",not
mitmproxy/mitmproxy/net/tcp.py,239,Section 4.2.2.13 of RFC 1122 tells us that a close() with any pending,not
mitmproxy/mitmproxy/net/tcp.py,240,readable data could lead to an immediate RST being sent (which is the,not
mitmproxy/mitmproxy/net/tcp.py,241,case on Windows).,not
mitmproxy/mitmproxy/net/tcp.py,242,http://ia600609.us.archive.org/22/items/TheUltimateSo_lingerPageOrWhyIsMyTcpNotReliable/the-ultimate-so_linger-page-or-why-is-my-tcp-not-reliable.html,not
mitmproxy/mitmproxy/net/tcp.py,243,,not
mitmproxy/mitmproxy/net/tcp.py,244,This in turn results in the following issue: If we send an error page,not
mitmproxy/mitmproxy/net/tcp.py,245,"to the client and then close the socket, the RST may be received by",not
mitmproxy/mitmproxy/net/tcp.py,246,the client before the error page and the users sees a connection,not
mitmproxy/mitmproxy/net/tcp.py,247,"error rather than the error page. Thus, we try to empty the read",not
mitmproxy/mitmproxy/net/tcp.py,248,buffer on Windows first. (see,not
mitmproxy/mitmproxy/net/tcp.py,249,https://github.com/mitmproxy/mitmproxy/issues/527#issuecomment-93782988),not
mitmproxy/mitmproxy/net/tcp.py,250,,not
mitmproxy/mitmproxy/net/tcp.py,252,pragma: no cover,not
mitmproxy/mitmproxy/net/tcp.py,253,We cannot rely on the shutdown()-followed-by-read()-eof technique,not
mitmproxy/mitmproxy/net/tcp.py,254,proposed by the page above: Some remote machines just don't send,not
mitmproxy/mitmproxy/net/tcp.py,255,"a TCP FIN, which would leave us in the unfortunate situation that",not
mitmproxy/mitmproxy/net/tcp.py,256,"recv() would block infinitely. As a workaround, we set a timeout",SATD
mitmproxy/mitmproxy/net/tcp.py,257,here even if we are in blocking mode.,not
mitmproxy/mitmproxy/net/tcp.py,260,limit at a megabyte so that we don't read infinitely,not
mitmproxy/mitmproxy/net/tcp.py,262,may raise a timeout/disconnect exception.,not
mitmproxy/mitmproxy/net/tcp.py,266,Now we can close the other half as well.,not
mitmproxy/mitmproxy/net/tcp.py,284,"Ideally, we would use the Buffered IO in Python 3 by default.",not
mitmproxy/mitmproxy/net/tcp.py,285,"Unfortunately, the implementation of .peek() is broken for n>1 bytes,",not
mitmproxy/mitmproxy/net/tcp.py,286,as it may just return what's left in the buffer and not all the bytes we want.,not
mitmproxy/mitmproxy/net/tcp.py,287,"As a workaround, we just use unbuffered sockets directly.",SATD
mitmproxy/mitmproxy/net/tcp.py,288,https://mail.python.org/pipermail/python-dev/2009-June/089986.html,not
mitmproxy/mitmproxy/net/tcp.py,317,"If we have an SSL connection, wfile.close == connection.close",not
mitmproxy/mitmproxy/net/tcp.py,318,(We call _FileLike.set_descriptor(conn)),not
mitmproxy/mitmproxy/net/tcp.py,319,"Closing the socket is not our task, therefore we don't call close",not
mitmproxy/mitmproxy/net/tcp.py,320,then.,not
mitmproxy/mitmproxy/net/tcp.py,373,"Make sure to close the real socket, not the SSL proxy.",not
mitmproxy/mitmproxy/net/tcp.py,374,"OpenSSL is really good at screwing up, i.e. when trying to recv from a failed connection,",not
mitmproxy/mitmproxy/net/tcp.py,375,it tries to renegotiate...,not
mitmproxy/mitmproxy/net/tcp.py,403,Keep all server certificates in a list,not
mitmproxy/mitmproxy/net/tcp.py,412,some parties (cuckoo sandbox) need to hook this,not
mitmproxy/mitmproxy/net/tcp.py,416,Based on the official socket.create_connection implementation of Python 3.6.,not
mitmproxy/mitmproxy/net/tcp.py,417,https://github.com/python/cpython/blob/3cc5817cfaf5663645f4ee447eaed603d2ad290a/Lib/socket.py,not
mitmproxy/mitmproxy/net/tcp.py,432,pragma: windows no cover  pragma: osx no cover,not
mitmproxy/mitmproxy/net/tcp.py,434,socket.IP_TRANSPARENT might not be available on every OS and Python version,not
mitmproxy/mitmproxy/net/tcp.py,451,pragma: no cover,not
mitmproxy/mitmproxy/net/tcp.py,515,pragma: no cover,not
mitmproxy/mitmproxy/net/tcp.py,561,"First try to bind an IPv6 socket, attempting to enable IPv4 support if the OS supports it.",not
mitmproxy/mitmproxy/net/tcp.py,562,This allows us to accept connections for ::1 and 127.0.0.1 on the same socket.,not
mitmproxy/mitmproxy/net/tcp.py,563,"Only works if self.address == """"",not
mitmproxy/mitmproxy/net/tcp.py,576,"Binding to an IPv6 + IPv4 socket failed, lets fall back to IPv4 only.",not
mitmproxy/mitmproxy/net/tcp.py,587,"Binding to an IPv4 only socket failed, lets fall back to IPv6 only.",not
mitmproxy/mitmproxy/net/tcp.py,601,pragma: no cover,not
mitmproxy/mitmproxy/net/tcp.py,602,This catches situations where the underlying connection is,not
mitmproxy/mitmproxy/net/tcp.py,603,closed beneath us. Syscalls on the connection object at this,not
mitmproxy/mitmproxy/net/tcp.py,604,"point returns EINVAL. If this happens, we close the socket and",not
mitmproxy/mitmproxy/net/tcp.py,605,move on.,SATD
mitmproxy/mitmproxy/net/tcp.py,651,"If a thread has persisted after interpreter exit, the module might be",not
mitmproxy/mitmproxy/net/tcp.py,652,none.,not
mitmproxy/mitmproxy/net/tcp.py,661,pragma: no cover,not
mitmproxy/mitmproxy/net/check.py,4,Allow underscore in host name,not
mitmproxy/mitmproxy/net/check.py,5,"Note: This could be a DNS label, a hostname, a FQDN, or an IP",not
mitmproxy/mitmproxy/net/check.py,17,RFC1035: 255 bytes or less.,not
mitmproxy/mitmproxy/net/check.py,22,DNS hostname,not
mitmproxy/mitmproxy/net/check.py,25,IPv4/IPv6 address,not
mitmproxy/mitmproxy/net/server_spec.py,44,"defaulting to https/port 443 may annoy some folks, but it's secure-by-default.",not
mitmproxy/mitmproxy/net/server_spec.py,50,IPv6 brackets,not
mitmproxy/mitmproxy/net/socks.py,199,We use tnoa here as ntop is not commonly available on Windows.,not
mitmproxy/mitmproxy/net/tls.py,1,To enable all SSL methods use: SSLv23,not
mitmproxy/mitmproxy/net/tls.py,2,then add options to disable certain methods,not
mitmproxy/mitmproxy/net/tls.py,3,https://bugs.launchpad.net/pyopenssl/+bug/1020632/comments/3,not
mitmproxy/mitmproxy/net/tls.py,40,SSLv23_METHOD + NO_SSLv2 + NO_SSLv3 == TLS 1.0+,not
mitmproxy/mitmproxy/net/tls.py,41,TLSv1_METHOD would be TLS 1.0 only,not
mitmproxy/mitmproxy/net/tls.py,86,"required for functools.wraps, which pyOpenSSL uses.",not
mitmproxy/mitmproxy/net/tls.py,93,this is a horrendous workaround for https://github.com/mitmproxy/mitmproxy/pull/3692#issuecomment-608454530:,SATD
mitmproxy/mitmproxy/net/tls.py,94,OpenSSL 1.1.1f decided to not make connection.master_key() fail in the SSL_CB_HANDSHAKE_DONE callback.,not
mitmproxy/mitmproxy/net/tls.py,95,"To support various OpenSSL versions and still log master secrets, we now mark connections where this has",not
mitmproxy/mitmproxy/net/tls.py,96,"happened and then try again on the next event. This is ugly and shouldn't be done, but eventually we",not
mitmproxy/mitmproxy/net/tls.py,97,replace this with context.set_keylog_callback anyways.,not
mitmproxy/mitmproxy/net/tls.py,112,careful: exception type changes between pyOpenSSL versions,not
mitmproxy/mitmproxy/net/tls.py,173,Options (NO_SSLv2/3),not
mitmproxy/mitmproxy/net/tls.py,177,Verify Options (NONE/PEER and trusted CAs),not
mitmproxy/mitmproxy/net/tls.py,191,Workaround for,SATD
mitmproxy/mitmproxy/net/tls.py,192,https://github.com/pyca/pyopenssl/issues/190,not
mitmproxy/mitmproxy/net/tls.py,193,https://github.com/mitmproxy/mitmproxy/issues/472,not
mitmproxy/mitmproxy/net/tls.py,194,Options already set before are not cleared.,not
mitmproxy/mitmproxy/net/tls.py,197,Cipher List,not
mitmproxy/mitmproxy/net/tls.py,204,SSLKEYLOGFILE,not
mitmproxy/mitmproxy/net/tls.py,209,advertise application layer protocols,not
mitmproxy/mitmproxy/net/tls.py,212,select application layer protocol,not
mitmproxy/mitmproxy/net/tls.py,216,pragma: no cover,not
mitmproxy/mitmproxy/net/tls.py,273,SSL_VERIFY_NONE: The handshake will be continued regardless of the verification result.,not
mitmproxy/mitmproxy/net/tls.py,283,Manually enable hostname verification on the context object.,not
mitmproxy/mitmproxy/net/tls.py,284,https://wiki.openssl.org/index.php/Hostname_validation,not
mitmproxy/mitmproxy/net/tls.py,286,"Matching on the CN is disabled in both Chrome and Firefox, so we disable it, too.",not
mitmproxy/mitmproxy/net/tls.py,287,https://www.chromestatus.com/feature/4981025180483584,not
mitmproxy/mitmproxy/net/tls.py,296,Client Certs,not
mitmproxy/mitmproxy/net/tls.py,313,Return true to prevent cert verification error,not
mitmproxy/mitmproxy/net/tls.py,369,SNI callback happens during do_handshake(),not
mitmproxy/mitmproxy/net/tls.py,386,"TLS ClientHello magic, works for SSLv3, TLSv1.0, TLSv1.1, TLSv1.2",not
mitmproxy/mitmproxy/net/tls.py,387,http://www.moserware.com/2009/06/first-few-milliseconds-of-https.html#client-hello,not
mitmproxy/mitmproxy/net/tls.py,477,exclude handshake header.,not
mitmproxy/mitmproxy/net/wsgi.py,163,pragma: no cover,not
mitmproxy/mitmproxy/net/http/request.py,14,This regex extracts & splits the host header into host and port.,not
mitmproxy/mitmproxy/net/http/request.py,15,Handles the edge case of IPv6 addresses containing colons.,not
mitmproxy/mitmproxy/net/http/request.py,16,https://bugzilla.mozilla.org/show_bug.cgi?id=45891,not
mitmproxy/mitmproxy/net/http/request.py,109,"Headers can be list or dict, we differentiate here.",not
mitmproxy/mitmproxy/net/http/request.py,119,Assign this manually to update the content-length header.,not
mitmproxy/mitmproxy/net/http/request.py,209,There's no non-strict mode for IDNA encoding.,not
mitmproxy/mitmproxy/net/http/request.py,210,"We don't want this operation to fail though, so we try",not
mitmproxy/mitmproxy/net/http/request.py,211,utf8 as a last resort.,not
mitmproxy/mitmproxy/net/http/request.py,218,Update host header,not
mitmproxy/mitmproxy/net/http/request.py,242,Update any existing headers.,not
mitmproxy/mitmproxy/net/http/request.py,248,Only add the correct new header.,not
mitmproxy/mitmproxy/net/http/request.py,322,Prefer the original address if host header has an unexpected form,not
mitmproxy/mitmproxy/net/http/request.py,387,This needs to be a tuple so that it's immutable.,not
mitmproxy/mitmproxy/net/http/request.py,388,"Otherwise, this would fail silently:",not
mitmproxy/mitmproxy/net/http/request.py,389,"request.path_components.append(""foo"")",not
mitmproxy/mitmproxy/net/http/cookies.py,38,See the StickyCookieTest for a weird cookie that only makes sense,not
mitmproxy/mitmproxy/net/http/cookies.py,39,if we take the last part.,not
mitmproxy/mitmproxy/net/http/cookies.py,44,"TODO: Should be List[Tuple[str,str]]?",SATD
mitmproxy/mitmproxy/net/http/cookies.py,71,Skip the first quote,not
mitmproxy/mitmproxy/net/http/cookies.py,72,initialize in case the loop doesn't run.,not
mitmproxy/mitmproxy/net/http/cookies.py,149,Special handling of attributes,not
mitmproxy/mitmproxy/net/http/cookies.py,151,'expires' values can contain commas in them so they need to,not
mitmproxy/mitmproxy/net/http/cookies.py,152,be handled separately.,not
mitmproxy/mitmproxy/net/http/cookies.py,154,We actually bank on the fact that the expires value WILL,not
mitmproxy/mitmproxy/net/http/cookies.py,155,"contain a comma. Things will fail, if they don't.",not
mitmproxy/mitmproxy/net/http/cookies.py,157,'3' is just a heuristic we use to determine whether we've,not
mitmproxy/mitmproxy/net/http/cookies.py,158,only read a part of the expires value and we should read more.,not
mitmproxy/mitmproxy/net/http/cookies.py,163,"as long as there's a ""="", we consider it a pair",not
mitmproxy/mitmproxy/net/http/cookies.py,169,comma marks the beginning of a new cookie,not
mitmproxy/mitmproxy/net/http/cookies.py,309,This can happen when the expires tag is invalid.,not
mitmproxy/mitmproxy/net/http/cookies.py,310,"reddit.com sends a an expires tag like this: ""Thu, 31 Dec",not
mitmproxy/mitmproxy/net/http/cookies.py,311,"2037 23:59:59 GMT"", which is valid RFC 1123, but not",not
mitmproxy/mitmproxy/net/http/cookies.py,312,strictly correct according to the cookie spec. Browsers,not
mitmproxy/mitmproxy/net/http/cookies.py,313,appear to parse this tolerantly - maybe we should too.,not
mitmproxy/mitmproxy/net/http/cookies.py,314,"For now, we just ignore this.",not
mitmproxy/mitmproxy/net/http/cookies.py,355,If no expiration information was provided with the cookie,not
mitmproxy/mitmproxy/net/http/cookies.py,372,First pair is always a new cookie,not
mitmproxy/mitmproxy/net/http/multipart.py,32,If boundary is found in value then raise ValueError,not
mitmproxy/mitmproxy/net/http/encoding.py,14,noqa,not
mitmproxy/mitmproxy/net/http/encoding.py,17,We have a shared single-element cache for encoding and decoding.,not
mitmproxy/mitmproxy/net/http/encoding.py,18,"This is quite useful in practice, e.g.",not
mitmproxy/mitmproxy/net/http/encoding.py,19,"flow.request.content = flow.request.content.replace(b""foo"", b""bar"")",not
mitmproxy/mitmproxy/net/http/encoding.py,20,"does not require an .encode() call if content does not contain b""foo""",not
mitmproxy/mitmproxy/net/http/encoding.py,151,"If the zstd stream is streamed without a size header,",not
mitmproxy/mitmproxy/net/http/encoding.py,152,try decoding with a 10MiB output buffer,not
mitmproxy/mitmproxy/net/http/status_codes.py,50,100,not
mitmproxy/mitmproxy/net/http/status_codes.py,54,200,not
mitmproxy/mitmproxy/net/http/status_codes.py,64,300,not
mitmproxy/mitmproxy/net/http/status_codes.py,71,306 not defined??,not
mitmproxy/mitmproxy/net/http/status_codes.py,74,400,not
mitmproxy/mitmproxy/net/http/status_codes.py,95,500,not
mitmproxy/mitmproxy/net/http/response.py,88,"Headers can be list or dict, we differentiate here.",not
mitmproxy/mitmproxy/net/http/response.py,98,Assign this manually to update the content-length header.,not
mitmproxy/mitmproxy/net/http/response.py,127,Encoding: http://stackoverflow.com/a/16674906/934719,not
mitmproxy/mitmproxy/net/http/message.py,2,noqa,not
mitmproxy/mitmproxy/net/http/message.py,100,A client may illegally specify a byte -> str encoding here (e.g. utf8),not
mitmproxy/mitmproxy/net/http/message.py,125,So we have an invalid content-encoding?,not
mitmproxy/mitmproxy/net/http/message.py,126,Let's remove it!,not
mitmproxy/mitmproxy/net/http/message.py,183,Use GB 18030 as the superset of GB2312 and GBK to fix common encoding problems on Chinese websites.,not
mitmproxy/mitmproxy/net/http/message.py,218,Fall back to UTF-8 and update the content-type header.,not
mitmproxy/mitmproxy/net/http/url.py,24,Size of Ascii character after encoding is 1 byte which is same as its size,not
mitmproxy/mitmproxy/net/http/url.py,25,But non-Ascii character's size after encoding will be more than its size,not
mitmproxy/mitmproxy/net/http/url.py,48,Returns None if port number invalid in Py3.5. Will throw ValueError in Py3.6,not
mitmproxy/mitmproxy/net/http/user_agents.py,6,pylint: line-too-long,not
mitmproxy/mitmproxy/net/http/user_agents.py,8,"A collection of (name, shortcut, string) tuples.",not
mitmproxy/mitmproxy/net/http/user_agents.py,13,noqa,not
mitmproxy/mitmproxy/net/http/user_agents.py,16,noqa,not
mitmproxy/mitmproxy/net/http/user_agents.py,19,noqa,not
mitmproxy/mitmproxy/net/http/user_agents.py,22,noqa,not
mitmproxy/mitmproxy/net/http/user_agents.py,25,noqa,not
mitmproxy/mitmproxy/net/http/user_agents.py,28,noqa,not
mitmproxy/mitmproxy/net/http/user_agents.py,31,noqa,not
mitmproxy/mitmproxy/net/http/user_agents.py,34,noqa,not
mitmproxy/mitmproxy/net/http/user_agents.py,37,noqa,not
mitmproxy/mitmproxy/net/http/user_agents.py,40,noqa,not
mitmproxy/mitmproxy/net/http/headers.py,7,See also: http://lucumr.pocoo.org/2013/7/2/the-updated-guide-to-unicode/,not
mitmproxy/mitmproxy/net/http/headers.py,10,"While headers _should_ be ASCII, it's not uncommon for certain headers to be utf-8 encoded.",not
mitmproxy/mitmproxy/net/http/headers.py,84,content_type -> content-type,not
mitmproxy/mitmproxy/net/http/headers.py,93,Headers can be folded,not
mitmproxy/mitmproxy/net/http/headers.py,98,Headers are case-insensitive,not
mitmproxy/mitmproxy/net/http/headers.py,175,"We get a ValueError if the replacement removed the "": """,not
mitmproxy/mitmproxy/net/http/headers.py,176,"There's not much we can do about this, so we just keep the header as-is.",not
mitmproxy/mitmproxy/net/http/http1/read.py,58,more accurate timestamp_start,not
mitmproxy/mitmproxy/net/http/http1/read.py,98,more accurate timestamp_start,not
mitmproxy/mitmproxy/net/http/http1/read.py,194,Determine response size according to,not
mitmproxy/mitmproxy/net/http/http1/read.py,195,http://tools.ietf.org/html/rfc7230#section-3.3,not
mitmproxy/mitmproxy/net/http/http1/read.py,234,Possible leftover from previous message,not
mitmproxy/mitmproxy/net/http/http1/read.py,247,We want to provide a better error message.,SATD
mitmproxy/mitmproxy/net/http/http1/read.py,296,We want to provide a better error message.,SATD
mitmproxy/mitmproxy/net/http/http1/read.py,301,handle missing message gracefully,not
mitmproxy/mitmproxy/net/http/http1/read.py,334,"we do have coverage of this, but coverage.py does not detect it.",not
mitmproxy/mitmproxy/net/http/http1/read.py,335,pragma: no cover,not
mitmproxy/mitmproxy/net/http/http1/read.py,339,continued header,not
mitmproxy/mitmproxy/net/websockets/frame.py,18,"RFC 6455, Section 5.2 - Base Framing Protocol",not
mitmproxy/mitmproxy/net/websockets/frame.py,28,"RFC 6455, Section 7.4.1 - Defined Status Codes",not
mitmproxy/mitmproxy/net/websockets/frame.py,135,'!H' pack as 16 bit unsigned short,not
mitmproxy/mitmproxy/net/websockets/frame.py,136,add 2 byte extended payload length,not
mitmproxy/mitmproxy/net/websockets/frame.py,139,'!Q' = pack as 64 bit unsigned long long,not
mitmproxy/mitmproxy/net/websockets/frame.py,140,add 8 bytes extended payload length,not
mitmproxy/mitmproxy/net/websockets/frame.py,163,payload_length > 125 indicates you need to read more bytes,not
mitmproxy/mitmproxy/net/websockets/frame.py,164,to get the actual payload length,not
mitmproxy/mitmproxy/net/websockets/frame.py,169,length_code == 127:,not
mitmproxy/mitmproxy/net/websockets/frame.py,172,masking key only present if mask bit set,not
mitmproxy/mitmproxy/contrib/kaitaistruct/exif_le.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/kaitaistruct/exif.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/kaitaistruct/gif.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/kaitaistruct/png.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/kaitaistruct/tls_client_hello.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/kaitaistruct/vlq_base128_le.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/kaitaistruct/jpeg.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/kaitaistruct/ico.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/kaitaistruct/exif_be.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/kaitaistruct/google_protobuf.py,1,This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild,not
mitmproxy/mitmproxy/contrib/wbxml/InvalidDataException.py,1,!/usr/bin/env python3,not
mitmproxy/mitmproxy/contrib/wbxml/ASCommandResponse.py,1,!/usr/bin/env python3,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXMLCodePage.py,1,!/usr/bin/env python3,not
mitmproxy/mitmproxy/contrib/wbxml/GlobalTokens.py,1,!/usr/bin/env python3,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXMLByteQueue.py,1,!/usr/bin/env python3,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXMLByteQueue.py,84,"TODO: Improve this handling. We are technically UTF-8, meaning",SATD
mitmproxy/mitmproxy/contrib/wbxml/ASWBXMLByteQueue.py,85,that characters could be more than one byte long. This will fail if we have,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXMLByteQueue.py,86,characters outside of the US-ASCII range,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,1,!/usr/bin/env python3,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,46,empty on init,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,51,Load up code pages,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,52,Currently there are 25 code pages as per MS-ASWBXML,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,55,region Code Page Initialization,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,56,Code Page 0: AirSync,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,57,region AirSync Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,96,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,98,Code Page 1: Contacts,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,99,region Contacts Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,159,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,161,Code Page 2: Email,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,162,region Email Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,213,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,215,Code Page 3: AirNotify - retired,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,216,region AirNotify Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,221,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,223,Code Page 4: Calendar,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,224,region Calendar Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,274,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,276,Code Page 5: Move,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,277,region Move Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,291,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,293,Code Page 6: ItemEstimate,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,294,region ItemEstimate Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,310,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,312,Code Page 7: FolderHierarchy,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,313,region FolderHierarchy Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,335,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,337,Code Page 8: MeetingResponse,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,338,region MeetingResponse Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,353,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,355,Code Page 9: Tasks,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,356,region Tasks Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,392,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,394,Code Page 10: ResolveRecipients,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,395,region ResolveRecipients Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,426,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,428,Code Page 11: ValidateCert,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,429,region ValidateCert Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,441,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,443,Code Page 12: Contacts2,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,444,region Contacts2 Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,460,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,462,Code Page 13: Ping,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,463,region Ping Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,469,"Per MS-ASWBXML, this tag is not used by protocol",not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,478,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,480,Code Page 14: Provision,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,481,region Provision Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,540,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,542,Code Page 15: Search,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,543,region Search Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,576,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,578,Code Page 16: GAL,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,579,region GAL Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,599,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,601,Code Page 17: AirSyncBase,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,602,region AirSyncBase Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,630,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,632,Code Page 18: Settings,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,633,region Settings Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,677,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,679,Code Page 19: DocumentLibrary,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,680,region DocumentLibrary Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,694,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,696,Code Page 20: ItemOperations,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,697,region ItemOperations Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,724,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,726,Code Page 21: ComposeMail,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,727,region ComposeMail Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,747,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,749,Code Page 22: Email2,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,750,region Email2 Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,771,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,773,Code Page 23: Notes,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,774,region Notes Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,785,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,787,Code Page 24: RightsManagement,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,788,region RightsManagement Code Page,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,814,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,815,endregion,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,818,note xmlDoc has .childNodes and .parentNode,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,833,Version is ignored,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,836,Public Identifier is ignored,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,841,Character set,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,842,"Currently only UTF-8 is supported, throw if something else",not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,847,String table length,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,848,"This should be 0, MS-ASWBXML does not use string tables",not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,853,Now we should be at the body of the data.,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,854,Add the declaration,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,895,not sure if this should be set on every node or not,not
mitmproxy/mitmproxy/contrib/wbxml/ASWBXML.py,896,"newNode.setAttribute(""xmlns"", self.codePages[self.currentCodePage].xmlns)",not
mitmproxy/mitmproxy/coretypes/multidict.py,198,All request-attributes are case-sensitive.,not
mitmproxy/mitmproxy/coretypes/multidict.py,203,We just return the first element if,not
mitmproxy/mitmproxy/coretypes/multidict.py,204,multiple elements exist with the same key.,not
mitmproxy/mitmproxy/script/concurrent.py,21,"When annotating classmethods, ""self"" is passed as the first argument.",not
mitmproxy/mitmproxy/script/concurrent.py,22,"To support both class and static methods, we accept a variable number of arguments",not
mitmproxy/mitmproxy/script/concurrent.py,23,and take the last one as our actual hook object.,not
mitmproxy/mitmproxy/tools/cmdline.py,43,Basic options,not
mitmproxy/mitmproxy/tools/cmdline.py,54,Proxy options,not
mitmproxy/mitmproxy/tools/cmdline.py,67,Proxy SSL options,not
mitmproxy/mitmproxy/tools/cmdline.py,73,Client replay,not
mitmproxy/mitmproxy/tools/cmdline.py,77,Server replay,not
mitmproxy/mitmproxy/tools/cmdline.py,84,Replacements,not
mitmproxy/mitmproxy/tools/cmdline.py,88,Set headers,not
mitmproxy/mitmproxy/tools/main.py,6,this is here for the version check to work on Python 2.,not
mitmproxy/mitmproxy/tools/main.py,11,"This must be before any mitmproxy imports, as they already break!",not
mitmproxy/mitmproxy/tools/main.py,12,Keep all other imports below with the 'noqa' magic comment.,not
mitmproxy/mitmproxy/tools/main.py,22,noqa,not
mitmproxy/mitmproxy/tools/_main.py,42,"also reduce log verbosity if --options or --commands is passed,",not
mitmproxy/mitmproxy/tools/_main.py,43,we don't want log messages from regular startup then.,not
mitmproxy/mitmproxy/tools/_main.py,64,pragma: no cover,not
mitmproxy/mitmproxy/tools/_main.py,76,To make migration from 2.x to 3.0 bearable.,not
mitmproxy/mitmproxy/tools/_main.py,122,Not supported on Windows,not
mitmproxy/mitmproxy/tools/_main.py,125,Make sure that we catch KeyboardInterrupts on Windows.,not
mitmproxy/mitmproxy/tools/_main.py,126,https://stackoverflow.com/a/36925722/934719,not
mitmproxy/mitmproxy/tools/_main.py,142,pragma: no cover,not
mitmproxy/mitmproxy/tools/_main.py,153,pragma: no cover,not
mitmproxy/mitmproxy/tools/_main.py,167,type: ignore,not
mitmproxy/mitmproxy/tools/_main.py,172,pragma: no cover,not
mitmproxy/mitmproxy/tools/web/app.py,15,noqa,not
mitmproxy/mitmproxy/tools/web/app.py,42,".alpn_proto_negotiated is bytes, we need to decode that.",not
mitmproxy/mitmproxy/tools/web/app.py,48,"There are some bytes in here as well, let's skip it until we have them in the UI.",not
mitmproxy/mitmproxy/tools/web/app.py,104,we just need some kind of id.,not
mitmproxy/mitmproxy/tools/web/app.py,118,Writing arrays on the top level is ok nowadays.,not
mitmproxy/mitmproxy/tools/web/app.py,119,http://flask.pocoo.org/docs/0.11/security/#json-security,not
mitmproxy/mitmproxy/tools/web/app.py,169,FIXME: Add a facility to addon.view to safely access the store,SATD
mitmproxy/mitmproxy/tools/web/app.py,185,https://github.com/tornadoweb/tornado/issues/645,not
mitmproxy/mitmproxy/tools/web/app.py,198,raise an error if inherited class doesn't specify its own instance.,not
mitmproxy/mitmproxy/tools/web/app.py,214,pragma: no cover,not
mitmproxy/mitmproxy/tools/web/app.py,401,if error:,not
mitmproxy/mitmproxy/tools/web/app.py,402,add event log,not
mitmproxy/mitmproxy/tools/web/app.py,465,try:,not
mitmproxy/mitmproxy/tools/web/app.py,466,"optmanager.save(self.master.options, CONFIG_PATH, True)",not
mitmproxy/mitmproxy/tools/web/app.py,467,except Exception as err:,not
mitmproxy/mitmproxy/tools/web/app.py,468,"raise APIError(400, ""{}"".format(err))",not
mitmproxy/mitmproxy/tools/web/app.py,498,make mitmweb accessible by IP only to prevent DNS rebinding.,not
mitmproxy/mitmproxy/tools/web/static_viewer.py,22,We want to overwrite the static files to keep track of the update.,not
mitmproxy/mitmproxy/tools/web/static_viewer.py,58,don't use raw_content here as this is served with a default content type,not
mitmproxy/mitmproxy/tools/web/static_viewer.py,64,content_view,not
mitmproxy/mitmproxy/tools/web/static_viewer.py,88,TODO: make this a command at some point.,SATD
mitmproxy/mitmproxy/tools/web/master.py,104,pragma: no cover,not
mitmproxy/mitmproxy/tools/console/searchable.py,77,Start search at focus + 1,not
mitmproxy/mitmproxy/tools/console/flowview.py,4,noqa,not
mitmproxy/mitmproxy/tools/console/flowview.py,18,noqa,not
mitmproxy/mitmproxy/tools/console/flowview.py,140,"Merge adjacent TCP ""messages"". For detailed explanation of this code block see:",not
mitmproxy/mitmproxy/tools/console/flowview.py,141,https://github.com/mitmproxy/mitmproxy/pull/3970/files/469bd32582f764f9a29607efa4f5b04bd87961fb#r418670880,not
mitmproxy/mitmproxy/tools/console/flowview.py,190,we need to pass the message off-band because it's not hashable,not
mitmproxy/mitmproxy/tools/console/flowview.py,203,Give hint that you have to tab for the response.,not
mitmproxy/mitmproxy/tools/console/flowview.py,207,"If the users has a wide terminal, he gets fewer lines; this should not be an issue.",not
mitmproxy/mitmproxy/tools/console/flowview.py,222,round up to the next line.,not
mitmproxy/mitmproxy/tools/console/flowview.py,240,"This will always force an ascii representation of headers. For example, if the server sends a",not
mitmproxy/mitmproxy/tools/console/flowview.py,241,,not
mitmproxy/mitmproxy/tools/console/flowview.py,242,X-Authors: Made with ❤ in Hamburg,not
mitmproxy/mitmproxy/tools/console/flowview.py,243,,not
mitmproxy/mitmproxy/tools/console/flowview.py,244,"header, mitmproxy will display the following:",not
mitmproxy/mitmproxy/tools/console/flowview.py,245,,not
mitmproxy/mitmproxy/tools/console/flowview.py,246,X-Authors: Made with \xe2\x9d\xa4 in Hamburg.,not
mitmproxy/mitmproxy/tools/console/flowview.py,247,,not
mitmproxy/mitmproxy/tools/console/flowview.py,248,The alternative would be to just use the header's UTF-8 representation and maybe,not
mitmproxy/mitmproxy/tools/console/flowview.py,249,"do `str.replace(""\t"", ""\\t"")` to exempt tabs from urwid's special characters escaping [1].",not
mitmproxy/mitmproxy/tools/console/flowview.py,250,"That would in some terminals allow rendering UTF-8 characters, but the mapping",not
mitmproxy/mitmproxy/tools/console/flowview.py,251,"wouldn't be bijective, i.e. a user couldn't distinguish ""\\t"" and ""\t"".",not
mitmproxy/mitmproxy/tools/console/flowview.py,252,"Also, from a security perspective, a mitmproxy user couldn't be fooled by homoglyphs.",not
mitmproxy/mitmproxy/tools/console/flowview.py,253,,not
mitmproxy/mitmproxy/tools/console/flowview.py,254,1) https://github.com/mitmproxy/mitmproxy/issues/1833,not
mitmproxy/mitmproxy/tools/console/flowview.py,255,"https://github.com/urwid/urwid/blob/6608ee2c9932d264abd1171468d833b7a4082e13/urwid/display_common.py#L35-L36,",not
mitmproxy/mitmproxy/tools/console/commands.py,157,This is essentially a copypasta from urwid.Pile's keypress handler.,not
mitmproxy/mitmproxy/tools/console/commands.py,158,"So much for ""closed for modification, but open for extension"".",not
mitmproxy/mitmproxy/tools/console/keybindings.py,92,Act here,not
mitmproxy/mitmproxy/tools/console/keybindings.py,152,This is essentially a copypasta from urwid.Pile's keypress handler.,not
mitmproxy/mitmproxy/tools/console/keybindings.py,153,"So much for ""closed for modification, but open for extension"".",not
mitmproxy/mitmproxy/tools/console/flowlist.py,5,noqa,not
mitmproxy/mitmproxy/tools/console/flowlist.py,48,The stub implementation of positions can go once this issue is resolved:,not
mitmproxy/mitmproxy/tools/console/flowlist.py,49,https://github.com/urwid/urwid/issues/294,not
mitmproxy/mitmproxy/tools/console/palettes.py,1,noqa,not
mitmproxy/mitmproxy/tools/console/palettes.py,2,Low-color themes should ONLY use the standard foreground and background,not
mitmproxy/mitmproxy/tools/console/palettes.py,3,colours listed here:,not
mitmproxy/mitmproxy/tools/console/palettes.py,4,,not
mitmproxy/mitmproxy/tools/console/palettes.py,5,http://urwid.org/manual/displayattributes.html,not
mitmproxy/mitmproxy/tools/console/palettes.py,6,,not
mitmproxy/mitmproxy/tools/console/palettes.py,14,Status bar & heading,not
mitmproxy/mitmproxy/tools/console/palettes.py,17,Help,not
mitmproxy/mitmproxy/tools/console/palettes.py,20,Options,not
mitmproxy/mitmproxy/tools/console/palettes.py,24,List and Connections,not
mitmproxy/mitmproxy/tools/console/palettes.py,34,Hex view,not
mitmproxy/mitmproxy/tools/console/palettes.py,37,JSON view,not
mitmproxy/mitmproxy/tools/console/palettes.py,40,TCP flow details,not
mitmproxy/mitmproxy/tools/console/palettes.py,43,Grid Editor,not
mitmproxy/mitmproxy/tools/console/palettes.py,46,Commander,not
mitmproxy/mitmproxy/tools/console/palettes.py,112,Status bar & heading,not
mitmproxy/mitmproxy/tools/console/palettes.py,117,Help,not
mitmproxy/mitmproxy/tools/console/palettes.py,122,Options,not
mitmproxy/mitmproxy/tools/console/palettes.py,128,List and Connections,not
mitmproxy/mitmproxy/tools/console/palettes.py,175,Hex view,not
mitmproxy/mitmproxy/tools/console/palettes.py,178,JSON view,not
mitmproxy/mitmproxy/tools/console/palettes.py,183,TCP flow details,not
mitmproxy/mitmproxy/tools/console/palettes.py,187,Grid Editor,not
mitmproxy/mitmproxy/tools/console/palettes.py,221,Status bar & heading,not
mitmproxy/mitmproxy/tools/console/palettes.py,226,Help,not
mitmproxy/mitmproxy/tools/console/palettes.py,231,Options,not
mitmproxy/mitmproxy/tools/console/palettes.py,237,List and Connections,not
mitmproxy/mitmproxy/tools/console/palettes.py,284,Hex view,not
mitmproxy/mitmproxy/tools/console/palettes.py,287,JSON view,not
mitmproxy/mitmproxy/tools/console/palettes.py,292,TCP flow details,not
mitmproxy/mitmproxy/tools/console/palettes.py,296,Grid Editor,not
mitmproxy/mitmproxy/tools/console/palettes.py,323,Solarized palette in Urwid-style terminal high-colour offsets,not
mitmproxy/mitmproxy/tools/console/palettes.py,324,See: http://ethanschoonover.com/solarized,not
mitmproxy/mitmproxy/tools/console/palettes.py,349,Status bar & heading,not
mitmproxy/mitmproxy/tools/console/palettes.py,354,Help,not
mitmproxy/mitmproxy/tools/console/palettes.py,358,Options,not
mitmproxy/mitmproxy/tools/console/palettes.py,364,List and Connections,not
mitmproxy/mitmproxy/tools/console/palettes.py,403,Hex view,not
mitmproxy/mitmproxy/tools/console/palettes.py,406,JSON view,not
mitmproxy/mitmproxy/tools/console/palettes.py,411,TCP flow details,not
mitmproxy/mitmproxy/tools/console/palettes.py,415,Grid Editor,not
mitmproxy/mitmproxy/tools/console/palettes.py,433,Status bar & heading,not
mitmproxy/mitmproxy/tools/console/palettes.py,438,Help,not
mitmproxy/mitmproxy/tools/console/palettes.py,442,Options,not
mitmproxy/mitmproxy/tools/console/palettes.py,448,List and Connections,not
mitmproxy/mitmproxy/tools/console/palettes.py,485,Hex view,not
mitmproxy/mitmproxy/tools/console/palettes.py,488,JSON view,not
mitmproxy/mitmproxy/tools/console/palettes.py,493,TCP flow details,not
mitmproxy/mitmproxy/tools/console/palettes.py,497,Grid Editor,not
mitmproxy/mitmproxy/tools/console/signals.py,4,Show a status message in the action bar,not
mitmproxy/mitmproxy/tools/console/signals.py,7,Prompt for input,not
mitmproxy/mitmproxy/tools/console/signals.py,10,Prompt for a path,not
mitmproxy/mitmproxy/tools/console/signals.py,13,Prompt for a single keystroke,not
mitmproxy/mitmproxy/tools/console/signals.py,16,Prompt for a command,not
mitmproxy/mitmproxy/tools/console/signals.py,19,Call a callback in N seconds,not
mitmproxy/mitmproxy/tools/console/signals.py,22,"Focus the body, footer or header of the main window",not
mitmproxy/mitmproxy/tools/console/signals.py,25,Fired when settings change,not
mitmproxy/mitmproxy/tools/console/signals.py,28,Fired when a flow changes,not
mitmproxy/mitmproxy/tools/console/signals.py,31,Fired when the flow list or focus changes,not
mitmproxy/mitmproxy/tools/console/signals.py,34,Pop and push view state onto a stack,not
mitmproxy/mitmproxy/tools/console/signals.py,38,Fired when the key bindings change,not
mitmproxy/mitmproxy/tools/console/options.py,197,Bust the focus widget cache,not
mitmproxy/mitmproxy/tools/console/options.py,276,This is essentially a copypasta from urwid.Pile's keypress handler.,not
mitmproxy/mitmproxy/tools/console/options.py,277,"So much for ""closed for modification, but open for extension"".",not
mitmproxy/mitmproxy/tools/console/window.py,41,Make sure that we don't propagate cursor events outside of the widget.,not
mitmproxy/mitmproxy/tools/console/window.py,42,"Otherwise, in a horizontal layout, urwid's Pile would change the focused widget",not
mitmproxy/mitmproxy/tools/console/window.py,43,if we cannot scroll any further.,not
mitmproxy/mitmproxy/tools/console/window.py,45,awkward as they don't implement a full dict api,SATD
mitmproxy/mitmproxy/tools/console/window.py,293,"args: (size, event, button, col, row)",not
mitmproxy/mitmproxy/tools/console/window.py,322,"replace urwid's SI/SO, which produce artifacts under WSL.",not
mitmproxy/mitmproxy/tools/console/window.py,323,at some point we may figure out what they actually do.,not
mitmproxy/mitmproxy/tools/console/master.py,12,noqa,not
mitmproxy/mitmproxy/tools/console/master.py,122,"if no EDITOR is set, assume 'vi'",not
mitmproxy/mitmproxy/tools/console/master.py,149,read-only to remind the user that this is a view function,not
mitmproxy/mitmproxy/tools/console/master.py,161,hm which one should get priority?,not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,251,We're now outside of the call context...,not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,278,We're now outside of the call context...,not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,412,"This shouldn't be necessary once this command is ""console.edit @focus"",",not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,413,but for now it is.,not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,444,Fix an issue caused by some editors when editing a,not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,445,request/response body. Many editors make it hard to save a,not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,446,file without a terminating newline on the last line. When,not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,447,"editing message bodies, this can cause problems. For now, I",not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,448,just strip the newlines off the end of the body when we return,not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,449,from an editor.,not
mitmproxy/mitmproxy/tools/console/consoleaddons.py,517,type: ignore,not
mitmproxy/mitmproxy/tools/console/layoutwidget.py,8,"Title is only required for windows, not overlay components",not
mitmproxy/mitmproxy/tools/console/statusbar.py,6,noqa,not
mitmproxy/mitmproxy/tools/console/statusbar.py,76,unicode ellipsis for the end of shortened message,not
mitmproxy/mitmproxy/tools/console/statusbar.py,82,First line of messages with a few lines must end with prompt.,not
mitmproxy/mitmproxy/tools/console/statusbar.py,175,Timed refresh time in seconds,not
mitmproxy/mitmproxy/tools/console/overlay.py,147,This is extremely awkward. We need a better way to match nav keys only.,SATD
mitmproxy/mitmproxy/tools/console/keymap.py,173,type: ignore,not
mitmproxy/mitmproxy/tools/console/flowdetailview.py,200,sort operations by timestamp,not
mitmproxy/mitmproxy/tools/console/common.py,16,Detect Windows Subsystem for Linux,not
mitmproxy/mitmproxy/tools/console/common.py,62,"We use dividechars=2 below, which already adds two empty spaces",not
mitmproxy/mitmproxy/tools/console/common.py,182,TODO: unicode?,SATD
mitmproxy/mitmproxy/tools/console/common.py,214,Work around https://github.com/urwid/urwid/pull/330,not
mitmproxy/mitmproxy/tools/console/common.py,299,bad URL,not
mitmproxy/mitmproxy/tools/console/common.py,306,://,not
mitmproxy/mitmproxy/tools/console/common.py,647,pass options directly if we need more stuff from them,not
mitmproxy/mitmproxy/tools/console/grideditor/editors.py,87,TODO: Next row on enter?,SATD
mitmproxy/mitmproxy/tools/console/grideditor/editors.py,219,"Whatever vals is, make it a list of rows containing lists of column values.",not
mitmproxy/mitmproxy/tools/console/grideditor/base.py,11,noqa,not
mitmproxy/mitmproxy/tools/console/grideditor/col_text.py,27,This is the same for both edit and display.,not
mitmproxy/mitmproxy/tools/console/grideditor/col_text.py,46,urwid forces a different name for a subclass.,not
mitmproxy/mitmproxy/tools/console/grideditor/__init__.py,1,noqa,not
mitmproxy/mitmproxy/tools/console/grideditor/__init__.py,2,noqa,not
mitmproxy/mitmproxy/tools/console/commander/commander.py,51,Cursor is always within the range [0:len(buffer)].,not
mitmproxy/mitmproxy/tools/console/commander/commander.py,77,"Means we just received the leader, so we need to give a blank",not
mitmproxy/mitmproxy/tools/console/commander/commander.py,78,text to the widget to render or it crashes,not
mitmproxy/mitmproxy/tools/console/commander/commander.py,150,We don't want to insert a space before the command,not
mitmproxy/mitmproxy/contentviews/xml_html.py,20,http://www.xml.com/pub/a/2001/07/25/namingparts.html - this is close enough for what we do.,not
mitmproxy/mitmproxy/contentviews/xml_html.py,22,https://www.w3.org/TR/html5/syntax.html#void-elements,not
mitmproxy/mitmproxy/contentviews/xml_html.py,84,"This fails for attributes that contain an unescaped "">""",not
mitmproxy/mitmproxy/contentviews/xml_html.py,118,Add spacing to first line so that we dedent in cases like this:,not
mitmproxy/mitmproxy/contentviews/xml_html.py,119,<li>This is,not
mitmproxy/mitmproxy/contentviews/xml_html.py,120,example text,not
mitmproxy/mitmproxy/contentviews/xml_html.py,121,over multiple lines,not
mitmproxy/mitmproxy/contentviews/xml_html.py,122,</li>,not
mitmproxy/mitmproxy/contentviews/xml_html.py,141,<div></div> (start tag),not
mitmproxy/mitmproxy/contentviews/xml_html.py,143,<div></div> (end tag),not
mitmproxy/mitmproxy/contentviews/xml_html.py,174,this closing tag has no start tag. let's keep indentation as-is.,not
mitmproxy/mitmproxy/contentviews/xml_html.py,200,self-closing,not
mitmproxy/mitmproxy/contentviews/xml_html.py,209,pragma: no cover,not
mitmproxy/mitmproxy/contentviews/xml_html.py,220,TODO:,SATD
mitmproxy/mitmproxy/contentviews/xml_html.py,221,"We should really have the message text as str here,",not
mitmproxy/mitmproxy/contentviews/xml_html.py,222,not the message content as bytes.,not
mitmproxy/mitmproxy/contentviews/xml_html.py,223,https://github.com/mitmproxy/mitmproxy/issues/1662#issuecomment-266192578,not
mitmproxy/mitmproxy/contentviews/xml_html.py,226,TODO:,SATD
mitmproxy/mitmproxy/contentviews/xml_html.py,227,Performance: Don't render the whole document right away.,not
mitmproxy/mitmproxy/contentviews/xml_html.py,228,"Let's wait with this until we have a sequence-like interface,",not
mitmproxy/mitmproxy/contentviews/xml_html.py,229,this thing is reasonably fast right now anyway.,not
mitmproxy/mitmproxy/contentviews/base.py,1,Default view cutoff *in lines*,not
mitmproxy/mitmproxy/contentviews/base.py,6,FIXME: This should be either bytes or str ultimately.,SATD
mitmproxy/mitmproxy/contentviews/base.py,35,pragma: no cover,not
mitmproxy/mitmproxy/contentviews/json.py,24,"rest_of_last_line is a delimiter such as , or [",not
mitmproxy/mitmproxy/contentviews/query.py,1,noqa,not
mitmproxy/mitmproxy/contentviews/raw.py,1,noqa,not
mitmproxy/mitmproxy/contentviews/__init__.py,17,noqa,not
mitmproxy/mitmproxy/contentviews/__init__.py,18,noqa,not
mitmproxy/mitmproxy/contentviews/__init__.py,41,TODO: auto-select a different name (append an integer?),SATD
mitmproxy/mitmproxy/contentviews/__init__.py,124,https://github.com/mitmproxy/mitmproxy/pull/3970#issuecomment-623024447,not
mitmproxy/mitmproxy/contentviews/__init__.py,150,Third-party viewers can fail in unexpected ways...,not
mitmproxy/mitmproxy/contentviews/__init__.py,164,The order in which ContentViews are added is important!,not
mitmproxy/mitmproxy/contentviews/css.py,33,Add newlines,not
mitmproxy/mitmproxy/contentviews/css.py,38,"Fix incorrect "":"" placement",SATD
mitmproxy/mitmproxy/contentviews/css.py,40,"Fix no space after "",""",not
mitmproxy/mitmproxy/contentviews/css.py,43,indent,not
mitmproxy/mitmproxy/contentviews/css.py,63,pragma: no cover,not
mitmproxy/mitmproxy/contentviews/image/view.py,19,there is also a fallback in the auto view for image/*.,not
mitmproxy/mitmproxy/addons/streambodies.py,48,"r.stream may already be a callable, which we want to preserve.",not
mitmproxy/mitmproxy/addons/session.py,32,Could be implemented using async libraries,not
mitmproxy/mitmproxy/addons/session.py,56,This is used for fast look-ups over bodies already dumped to database.,not
mitmproxy/mitmproxy/addons/session.py,57,This permits to enforce one-to-one relationship between flow and body table.,not
mitmproxy/mitmproxy/addons/session.py,117,"Some live components of flows cannot be serialized, but they are needed to ensure correct functionality.",not
mitmproxy/mitmproxy/addons/session.py,118,"We solve this by keeping a list of tuples which ""save"" those components for each flow id, eventually",not
mitmproxy/mitmproxy/addons/session.py,119,adding them back when needed.,not
mitmproxy/mitmproxy/addons/session.py,278,A same flow could be at the same time in hot and db storage. We want the most updated version.,not
mitmproxy/mitmproxy/addons/clientplayback.py,45,pragma: no cover,not
mitmproxy/mitmproxy/addons/clientplayback.py,54,"If we have a channel, run script hooks.",not
mitmproxy/mitmproxy/addons/clientplayback.py,60,"In all modes, we directly connect to the server displayed",not
mitmproxy/mitmproxy/addons/clientplayback.py,201,Prepare the flow for replay,not
mitmproxy/mitmproxy/addons/clientplayback.py,206,https://github.com/mitmproxy/mitmproxy/issues/2197,not
mitmproxy/mitmproxy/addons/save.py,47,We're already streaming - stop the previous stream and restart,not
mitmproxy/mitmproxy/addons/proxyauth.py,5,noqa,not
mitmproxy/mitmproxy/addons/proxyauth.py,11,noqa,not
mitmproxy/mitmproxy/addons/proxyauth.py,141,Handlers,not
mitmproxy/mitmproxy/addons/proxyauth.py,201,TODO: check for multiple auth options,SATD
mitmproxy/mitmproxy/addons/proxyauth.py,210,Is this connection authenticated by a previous HTTP CONNECT?,not
mitmproxy/mitmproxy/addons/script.py,23,"the fullname is not unique among scripts, so if there already is an existing script with said",not
mitmproxy/mitmproxy/addons/script.py,24,"fullname, remove it.",not
mitmproxy/mitmproxy/addons/script.py,35,type: ignore,not
mitmproxy/mitmproxy/addons/script.py,105,"We're already running, so we have to explicitly register and",not
mitmproxy/mitmproxy/addons/script.py,106,configure the addon,not
mitmproxy/mitmproxy/addons/script.py,186,The machinations below are to ensure that:,not
mitmproxy/mitmproxy/addons/script.py,187,- Scripts remain in the same order,not
mitmproxy/mitmproxy/addons/script.py,188,- Scripts are not initialized un-necessarily. If only a,not
mitmproxy/mitmproxy/addons/script.py,189,"script's order in the script list has changed, it is just",not
mitmproxy/mitmproxy/addons/script.py,190,moved.,not
mitmproxy/mitmproxy/addons/script.py,211,"If we're already running, we configure and tell the addon",not
mitmproxy/mitmproxy/addons/script.py,212,we're up and running.,not
mitmproxy/mitmproxy/addons/readfile.py,90,pragma: no cover,not
mitmproxy/mitmproxy/addons/readfile.py,91,Need to think about how to test this. This function is scheduled,not
mitmproxy/mitmproxy/addons/readfile.py,92,"onto the event loop, where a sys.stdin mock has no effect.",not
mitmproxy/mitmproxy/addons/stickycookie.py,3,noqa,not
mitmproxy/mitmproxy/addons/stickycookie.py,25,type: ignore,not
mitmproxy/mitmproxy/addons/stickycookie.py,27,type: ignore,not
mitmproxy/mitmproxy/addons/stickycookie.py,59,FIXME: We now know that Cookie.py screws up some cookies with,SATD
mitmproxy/mitmproxy/addons/stickycookie.py,60,valid RFC 822/1123 datetime specifications for expiry. Sigh.,not
mitmproxy/mitmproxy/addons/stickycookie.py,65,Remove the cookie from jar,not
mitmproxy/mitmproxy/addons/stickycookie.py,68,If all cookies of a dom_port_path have been removed,not
mitmproxy/mitmproxy/addons/stickycookie.py,69,then remove it from the jar itself,not
mitmproxy/mitmproxy/addons/stickycookie.py,88,FIXME: we need to formalise this...,SATD
mitmproxy/mitmproxy/addons/eventstore.py,2,noqa,not
mitmproxy/mitmproxy/addons/replace.py,79,We should ideally escape here before trying to compile,not
mitmproxy/mitmproxy/addons/browser.py,13,https://stackoverflow.com/questions/40674914/google-chrome-path-in-windows-10,not
mitmproxy/mitmproxy/addons/browser.py,16,Linux binary names from Python's webbrowser module.,not
mitmproxy/mitmproxy/addons/command_history.py,28,FIXME: We have a weird bug where the contract for configure is not followed and it is never called with,SATD
mitmproxy/mitmproxy/addons/command_history.py,29,confdir or command_history as updated.,not
mitmproxy/mitmproxy/addons/command_history.py,30,pragma: no cover,not
mitmproxy/mitmproxy/addons/command_history.py,40,vacuum history so that it doesn't grow indefinitely.,not
mitmproxy/mitmproxy/addons/command_history.py,69,Functionality to provide a filtered list that can be iterated through.,not
mitmproxy/mitmproxy/addons/termlog.py,7,These get over-ridden by the save execution context. Keep them around so we,not
mitmproxy/mitmproxy/addons/termlog.py,8,can log directly.,not
mitmproxy/mitmproxy/addons/dumper.py,7,noqa,not
mitmproxy/mitmproxy/addons/dumper.py,24,we can already indent here,not
mitmproxy/mitmproxy/addons/dumper.py,157,"We hide ""normal"" HTTP 1.",not
mitmproxy/mitmproxy/addons/dumper.py,202,This aligns the HTTP response code with the HTTP request method:,not
mitmproxy/mitmproxy/addons/dumper.py,203,127.0.0.1:59519: GET http://example.com/,not
mitmproxy/mitmproxy/addons/dumper.py,204,<< 304 Not Modified 0b,not
mitmproxy/mitmproxy/addons/intercept.py,45,Handlers,not
mitmproxy/mitmproxy/addons/disable_h2c.py,35,Handlers,not
mitmproxy/mitmproxy/addons/export.py,21,a bit of clean-up - these headers should be automatically set by curl/httpie,not
mitmproxy/mitmproxy/addons/export.py,34,type: ignore,not
mitmproxy/mitmproxy/addons/export.py,44,shlex.quote doesn't support a bytes object,not
mitmproxy/mitmproxy/addons/export.py,45,see https://github.com/python/cpython/pull/10871,not
mitmproxy/mitmproxy/addons/export.py,92,type: ignore,not
mitmproxy/mitmproxy/addons/export.py,93,type: ignore,not
mitmproxy/mitmproxy/addons/view.py,29,The underlying sorted list implementation expects the sort key to be stable,not
mitmproxy/mitmproxy/addons/view.py,30,"for the lifetime of the object. However, if we sort by size, for instance,",not
mitmproxy/mitmproxy/addons/view.py,31,the sort order changes as the flow progresses through its lifecycle. We,not
mitmproxy/mitmproxy/addons/view.py,32,address this through two means:,not
mitmproxy/mitmproxy/addons/view.py,33,,not
mitmproxy/mitmproxy/addons/view.py,34,- Let order keys cache the sort value by flow ID.,not
mitmproxy/mitmproxy/addons/view.py,35,,not
mitmproxy/mitmproxy/addons/view.py,36,- Add a facility to refresh items in the list by removing and re-adding them,not
mitmproxy/mitmproxy/addons/view.py,37,when they are updated.,not
mitmproxy/mitmproxy/addons/view.py,44,pragma: no cover,not
mitmproxy/mitmproxy/addons/view.py,131,Should we show only marked flows?,not
mitmproxy/mitmproxy/addons/view.py,147,"The sig_view* signals broadcast events that affect the view. That is,",not
mitmproxy/mitmproxy/addons/view.py,148,an update to a flow in the store but not in the view does not trigger,not
mitmproxy/mitmproxy/addons/view.py,149,a signal. All signals are called after the view has been updated.,not
mitmproxy/mitmproxy/addons/view.py,153,Signals that the view should be refreshed completely,not
mitmproxy/mitmproxy/addons/view.py,156,The sig_store* signals broadcast events that affect the underlying,not
mitmproxy/mitmproxy/addons/view.py,157,"store. If a flow is removed from just the view, sig_view_remove is",not
mitmproxy/mitmproxy/addons/view.py,158,triggered. If it is removed from the store while it is also in the,not
mitmproxy/mitmproxy/addons/view.py,159,"view, both sig_store_remove and sig_view_remove are triggered.",not
mitmproxy/mitmproxy/addons/view.py,161,Signals that the store should be refreshed completely,not
mitmproxy/mitmproxy/addons/view.py,208,Reflect some methods to the efficient underlying implementation,not
mitmproxy/mitmproxy/addons/view.py,238,Focus,not
mitmproxy/mitmproxy/addons/view.py,280,Order,not
mitmproxy/mitmproxy/addons/view.py,319,Filter,not
mitmproxy/mitmproxy/addons/view.py,338,View Updates,not
mitmproxy/mitmproxy/addons/view.py,361,View Settings,not
mitmproxy/mitmproxy/addons/view.py,401,Flows,not
mitmproxy/mitmproxy/addons/view.py,424,We manually pass the index here because multiple flows may have the same,not
mitmproxy/mitmproxy/addons/view.py,425,"sorting key, and we cannot reconstruct the index from that.",not
mitmproxy/mitmproxy/addons/view.py,478,"Do this to get a new ID, so we can load the same file N times and",not
mitmproxy/mitmproxy/addons/view.py,479,get new flows each time. It would be more efficient to just have a,not
mitmproxy/mitmproxy/addons/view.py,480,.newid() method or something.,not
mitmproxy/mitmproxy/addons/view.py,508,View Properties,not
mitmproxy/mitmproxy/addons/view.py,538,Event handlers,not
mitmproxy/mitmproxy/addons/view.py,603,This is a tad complicated. The sortedcontainers,not
mitmproxy/mitmproxy/addons/view.py,604,implementation assumes that the order key is stable. If,not
mitmproxy/mitmproxy/addons/view.py,605,it changes mid-way Very Bad Things happen. We detect when,not
mitmproxy/mitmproxy/addons/view.py,606,"this happens, and re-fresh the item.",not
mitmproxy/mitmproxy/addons/view.py,613,The value was not in the view,not
mitmproxy/mitmproxy/addons/view.py,674,We only have to act if we don't have a focus element,not
mitmproxy/mitmproxy/addons/upstream_auth.py,42,FIXME: We're doing this because our proxy core is terminally confused,SATD
mitmproxy/mitmproxy/addons/upstream_auth.py,43,"at the moment. Ideally, we should be able to check if we're in",not
mitmproxy/mitmproxy/addons/upstream_auth.py,44,"reverse proxy mode at the HTTP layer, so that scripts can put the",not
mitmproxy/mitmproxy/addons/upstream_auth.py,45,proxy in reverse proxy mode for specific requests.,not
mitmproxy/mitmproxy/addons/cut.py,73,type: ignore,not
mitmproxy/mitmproxy/addons/cut.py,98,We're appending to a file that already exists and has content,not
mitmproxy/mitmproxy/addons/cut.py,112,type: ignore,not
mitmproxy/mitmproxy/addons/cut.py,133,type: ignore,not
mitmproxy/mitmproxy/addons/keepserving.py,24,pragma: no cover,not
mitmproxy/mitmproxy/addons/core.py,109,FIXME: this will become view.mark later,SATD
mitmproxy/mitmproxy/addons/core.py,122,FIXME: this will become view.mark.toggle later,SATD
mitmproxy/mitmproxy/addons/core.py,145,FIXME: this will become view.revert later,SATD
mitmproxy/mitmproxy/addons/core.py,184,type: ignore,not
mitmproxy/mitmproxy/addons/core.py,217,type: ignore,not
mitmproxy/mitmproxy/addons/onboardingapp/__init__.py,8,"will be overridden in the addon, setting this here so that the Flask app can be run standalone.",not
mitmproxy/mitmproxy/io/compat.py,9,noqa,not
mitmproxy/mitmproxy/io/compat.py,62,convert_unicode needs to be called for every dual release and the first py3-only release,not
mitmproxy/mitmproxy/io/compat.py,72,convert_unicode needs to be called for every dual release and the first py3-only release,not
mitmproxy/mitmproxy/io/compat.py,91,convert_unicode needs to be called for every dual release and the first py3-only release,not
mitmproxy/mitmproxy/io/compat.py,126,This is an empty migration to transition to the new versioning scheme.,not
mitmproxy/mitmproxy/io/compat.py,185,pragma: no cover,not
mitmproxy/mitmproxy/io/compat.py,236,"Historically, we used the mitmproxy minor version tuple as the flow format version.",not
mitmproxy/mitmproxy/io/tnetstring.py,53,"This uses a deque to collect output fragments in reverse order,",not
mitmproxy/mitmproxy/io/tnetstring.py,54,then joins them together at the end.  It's measurably faster,not
mitmproxy/mitmproxy/io/tnetstring.py,55,than creating all the intermediate strings.,not
mitmproxy/mitmproxy/io/tnetstring.py,102,Use repr() for float rather than str().,not
mitmproxy/mitmproxy/io/tnetstring.py,103,It round-trips more accurately.,not
mitmproxy/mitmproxy/io/tnetstring.py,104,Probably unnecessary in later python versions that,not
mitmproxy/mitmproxy/io/tnetstring.py,105,use David Gay's ftoa routines.,not
mitmproxy/mitmproxy/io/tnetstring.py,166,Read the length prefix one char at a time.,not
mitmproxy/mitmproxy/io/tnetstring.py,167,Note that the netstring spec explicitly forbids padding zeros.,not
mitmproxy/mitmproxy/io/tnetstring.py,169,we want to detect this special case.,not
mitmproxy/mitmproxy/io/tnetstring.py,216,type: ignore,not
mitmproxy/mitmproxy/io/tnetstring.py,223,type: ignore,not
mitmproxy/mitmproxy/io/tnetstring.py,234,"Parse out data length, type and remaining string.",not
mitmproxy/mitmproxy/io/tnetstring.py,243,"This fires if len(data) < dlen, meaning we don't need",not
mitmproxy/mitmproxy/io/tnetstring.py,244,to further validate that data is the right length.,not
mitmproxy/mitmproxy/io/tnetstring.py,246,Parse the data based on the type tag.,not
mitmproxy/mitmproxy/io/io.py,2,noqa,not
mitmproxy/mitmproxy/io/io.py,40,FIXME: This cast hides a lack of dynamic type checking,SATD
mitmproxy/mitmproxy/io/io.py,54,Error is due to EOF,not
mitmproxy/mitmproxy/io/protobuf.py,18,ugly fix to set None in empty str or bytes fields,SATD
mitmproxy/mitmproxy/io/proto/http_pb2.py,1,Generated by the protocol buffer compiler.  DO NOT EDIT!,not
mitmproxy/mitmproxy/io/proto/http_pb2.py,2,source: http.proto,not
mitmproxy/mitmproxy/io/proto/http_pb2.py,11,@@protoc_insertion_point(imports),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,718,@@protoc_insertion_point(class_scope:HTTPFlow),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,725,@@protoc_insertion_point(class_scope:HTTPRequest),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,732,@@protoc_insertion_point(class_scope:HTTPResponse),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,739,@@protoc_insertion_point(class_scope:HTTPError),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,746,@@protoc_insertion_point(class_scope:HTTPHeader),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,753,@@protoc_insertion_point(class_scope:Address),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,760,@@protoc_insertion_point(class_scope:ClientConnection),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,767,@@protoc_insertion_point(class_scope:ServerConnection),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,774,@@protoc_insertion_point(class_scope:TLSExtension),not
mitmproxy/mitmproxy/io/proto/http_pb2.py,779,@@protoc_insertion_point(module_scope),not
mitmproxy/release/cibuild.py,1,!/usr/bin/env python3,not
mitmproxy/release/cibuild.py,23,pragma: no cover,not
mitmproxy/release/cibuild.py,128,ZipFile and tarfile have slightly different APIs. Fix that.,not
mitmproxy/release/cibuild.py,221,"For production releases, we require strict version equality",not
mitmproxy/release/cibuild.py,225,Commits on maintenance branches don't need the dev suffix. This,not
mitmproxy/release/cibuild.py,226,allows us to incorporate and test commits between tagged releases.,not
mitmproxy/release/cibuild.py,227,"For snapshots, we only ensure that mitmproxy/version.py contains a",not
mitmproxy/release/cibuild.py,228,dev release.,not
mitmproxy/release/cibuild.py,332,pragma: no cover,not
mitmproxy/release/cibuild.py,347,pragma: no cover,not
mitmproxy/release/cibuild.py,359,smoke-test the newly built docker image,not
mitmproxy/release/cibuild.py,372,pragma: no cover,not
mitmproxy/release/cibuild.py,376,PyInstaller 3.2 does not bundle pydivert's Windivert binaries,not
mitmproxy/release/cibuild.py,381,https://virtualenv.pypa.io/en/latest/userguide.html#windows-notes,not
mitmproxy/release/cibuild.py,382,scripts and executables on Windows go in ENV\Scripts\ instead of ENV/bin/,not
mitmproxy/release/cibuild.py,385,PyInstaller < 3.2 does not handle Python 3.5's ucrt correctly.,not
mitmproxy/release/cibuild.py,399,We can't have a folder and a file with the same name.,not
mitmproxy/release/cibuild.py,402,"This is PyInstaller, so it messes up paths.",not
mitmproxy/release/cibuild.py,403,We need to make sure that we are in the spec folder.,not
mitmproxy/release/cibuild.py,422,"This is PyInstaller, so setting a",not
mitmproxy/release/cibuild.py,423,different log level obviously breaks it :-),not
mitmproxy/release/cibuild.py,424,"""--log-level"", ""WARN"",",not
mitmproxy/release/cibuild.py,430,Delete the spec file - we're good without.,not
mitmproxy/release/cibuild.py,433,Test if it works at all O:-),not
mitmproxy/release/cibuild.py,438,Remove _main suffix from mitmproxy executable,not
mitmproxy/release/cibuild.py,453,pragma: no cover,not
mitmproxy/release/cibuild.py,506,pragma: no cover,not
mitmproxy/release/cibuild.py,514,pragma: no cover,not
mitmproxy/release/cibuild.py,535,pragma: no cover,not
mitmproxy/release/cibuild.py,580,pragma: no cover,not
mitmproxy/release/hooks/hook-cryptography.py,1,Taken from the latest pyinstaller master on 2016-11-27 (0729a2b).,not
mitmproxy/release/hooks/hook-cryptography.py,2,flake8: noqa,not
mitmproxy/release/hooks/hook-cryptography.py,4,-----------------------------------------------------------------------------,not
mitmproxy/release/hooks/hook-cryptography.py,5,"Copyright (c) 2005-2016, PyInstaller Development Team.",not
mitmproxy/release/hooks/hook-cryptography.py,6,,not
mitmproxy/release/hooks/hook-cryptography.py,7,Distributed under the terms of the GNU General Public License with exception,not
mitmproxy/release/hooks/hook-cryptography.py,8,for distributing bootloader.,not
mitmproxy/release/hooks/hook-cryptography.py,9,,not
mitmproxy/release/hooks/hook-cryptography.py,10,"The full license is in the file COPYING.txt, distributed with this software.",not
mitmproxy/release/hooks/hook-cryptography.py,11,-----------------------------------------------------------------------------,not
mitmproxy/release/hooks/hook-cryptography.py,25,get the package data so we can load the backends,not
mitmproxy/release/hooks/hook-cryptography.py,28,Add the backends as hidden imports,not
mitmproxy/release/hooks/hook-cryptography.py,31,Add the OpenSSL FFI binding modules as hidden imports,not
mitmproxy/release/hooks/hook-cryptography.py,35,Include the cffi extensions as binaries in a subfolder named like the package.,not
mitmproxy/release/hooks/hook-cryptography.py,36,The cffi verifier expects to find them inside the package directory for,not
mitmproxy/release/hooks/hook-cryptography.py,37,the main module. We cannot use hiddenimports because that would add the modules,not
mitmproxy/release/hooks/hook-cryptography.py,38,outside the package.,not
mitmproxy/release/hooks/hook-pkg_resources.py,1,flake8: noqa,not
mitmproxy/release/hooks/hook-pkg_resources.py,3,temporary fix for https://github.com/pypa/setuptools/issues/1963,not
mitmproxy/release/hooks/hook-pkg_resources.py,4,can be removed when we upgrade to PyInstaller 3.7.,not
mitmproxy/examples/simple/websocket_messages.py,6,get the latest message,not
mitmproxy/examples/simple/websocket_messages.py,9,was the message sent from the client or server?,not
mitmproxy/examples/simple/websocket_messages.py,15,manipulate the message content,not
mitmproxy/examples/simple/websocket_messages.py,19,kill the message and not send it to the other endpoint,not
mitmproxy/examples/simple/send_reply_from_proxy.py,9,"pretty_url takes the ""Host"" header of the request into account, which",not
mitmproxy/examples/simple/send_reply_from_proxy.py,10,is useful in transparent mode where we usually only have the IP otherwise.,not
mitmproxy/examples/simple/send_reply_from_proxy.py,14,(optional) status code,not
mitmproxy/examples/simple/send_reply_from_proxy.py,15,(optional) content,not
mitmproxy/examples/simple/send_reply_from_proxy.py,16,(optional) headers,not
mitmproxy/examples/simple/wsgi_flask_app.py,18,"Host app at the magic domain ""example.com"" on port 80. Requests to this",not
mitmproxy/examples/simple/wsgi_flask_app.py,19,domain and port combination will now be routed to the WSGI app instance.,not
mitmproxy/examples/simple/wsgi_flask_app.py,21,"SSL works too, but the magic domain needs to be resolvable from the mitmproxy machine due to mitmproxy's design.",not
mitmproxy/examples/simple/wsgi_flask_app.py,22,mitmproxy will connect to said domain and use serve its certificate (unless --no-upstream-cert is set),not
mitmproxy/examples/simple/wsgi_flask_app.py,23,but won't send any data.,not
mitmproxy/examples/simple/wsgi_flask_app.py,24,"mitmproxy.ctx.master.apps.add(app, ""example.com"", 443)",not
mitmproxy/examples/simple/io_write_dumpfile.py,11,noqa,not
mitmproxy/examples/simple/redirect_requests.py,8,"pretty_host takes the ""Host"" header of the request into account,",not
mitmproxy/examples/simple/redirect_requests.py,9,which is useful in transparent mode where we usually only have the IP,not
mitmproxy/examples/simple/redirect_requests.py,10,otherwise.,not
mitmproxy/examples/simple/modify_body_inject_iframe.py,1,(this script works best with --anticache),not
mitmproxy/examples/simple/link_expander.py,1,This script determines if request is an HTML webpage and if so seeks out,not
mitmproxy/examples/simple/link_expander.py,2,"relative links (<a href=""./about.html"">) and expands them to absolute links",not
mitmproxy/examples/simple/link_expander.py,3,In practice this can be used to front an indexing spider that may not have the capability to expand relative page links.,not
mitmproxy/examples/simple/link_expander.py,4,Usage: mitmdump -s link_expander.py or mitmproxy -s link_expander.py,not
mitmproxy/examples/simple/link_expander.py,26,Uncomment the following to print the expansion mapping,not
mitmproxy/examples/simple/link_expander.py,27,"print(""{0} -> {1}"".format(*map))",not
mitmproxy/examples/simple/modify_form.py,6,"If there's already a form, one can just add items to the dict:",not
mitmproxy/examples/simple/modify_form.py,9,One can also just pass new form data.,not
mitmproxy/examples/simple/modify_form.py,10,This sets the proper content type and overrides the body.,not
mitmproxy/examples/simple/io_read_dumpfile.py,1,!/usr/bin/env python,not
mitmproxy/examples/simple/io_read_dumpfile.py,2,,not
mitmproxy/examples/simple/io_read_dumpfile.py,3,Simple script showing how to read a mitmproxy dump file,not
mitmproxy/examples/simple/io_read_dumpfile.py,4,,not
mitmproxy/examples/pathod/test_context.py,10,Start pathod in a separate thread,not
mitmproxy/examples/pathod/test_context.py,12,Get a URL for a pathod spec,not
mitmproxy/examples/pathod/test_context.py,14,... and request it,not
mitmproxy/examples/pathod/test_context.py,17,Check the returned data,not
mitmproxy/examples/pathod/test_context.py,21,Check pathod's internal log,not
mitmproxy/examples/pathod/libpathod_pathoc.py,1,!/usr/bin/env python,not
mitmproxy/examples/pathod/test_setupall.py,21,Clear the pathod logs between tests,not
mitmproxy/examples/pathod/test_setupall.py,25,Get a URL for a pathod spec,not
mitmproxy/examples/pathod/test_setupall.py,27,... and request it,not
mitmproxy/examples/pathod/test_setupall.py,30,Check the returned data,not
mitmproxy/examples/pathod/test_setupall.py,34,Check pathod's internal log,not
mitmproxy/examples/pathod/test_setup.py,19,Get a URL for a pathod spec,not
mitmproxy/examples/pathod/test_setup.py,21,... and request it,not
mitmproxy/examples/pathod/test_setup.py,24,Check the returned data,not
mitmproxy/examples/pathod/test_setup.py,28,Check pathod's internal log,not
mitmproxy/examples/addons/events-websocket-specific.py,6,Websocket lifecycle,not
mitmproxy/examples/addons/events-tcp-specific.py,5,TCP lifecycle,not
mitmproxy/examples/addons/events-http-specific.py,5,HTTP lifecycle,not
mitmproxy/examples/addons/events.py,13,Network lifecycle,not
mitmproxy/examples/addons/events.py,42,General lifecycle,not
mitmproxy/examples/complex/change_upstream_proxy.py,4,This scripts demonstrates how mitmproxy can switch to a second/different upstream proxy,not
mitmproxy/examples/complex/change_upstream_proxy.py,5,in upstream proxy mode.,not
mitmproxy/examples/complex/change_upstream_proxy.py,6,,not
mitmproxy/examples/complex/change_upstream_proxy.py,7,Usage: mitmdump -U http://default-upstream-proxy.local:8080/ -s change_upstream_proxy.py,not
mitmproxy/examples/complex/change_upstream_proxy.py,8,,not
mitmproxy/examples/complex/change_upstream_proxy.py,9,"If you want to change the target server, you should modify flow.request.host and flow.request.port",not
mitmproxy/examples/complex/change_upstream_proxy.py,13,Poor man's loadbalancing: route every second domain through the alternative proxy.,not
mitmproxy/examples/complex/change_upstream_proxy.py,22,"If the decision is done by domain, one could also modify the server address here.",SATD
mitmproxy/examples/complex/change_upstream_proxy.py,23,We do it after CONNECT here to have the request data available as well.,not
mitmproxy/examples/complex/change_upstream_proxy.py,27,type: ignore,not
mitmproxy/examples/complex/har_dump.py,16,noqa,not
mitmproxy/examples/complex/har_dump.py,23,noqa,not
mitmproxy/examples/complex/har_dump.py,31,A list of server seen till now is maintained so we can avoid,not
mitmproxy/examples/complex/har_dump.py,32,using 'connect' time for entries that use an existing connection.,not
mitmproxy/examples/complex/har_dump.py,61,-1 indicates that these values do not apply to current request,not
mitmproxy/examples/complex/har_dump.py,75,Calculate raw timings from timestamps. DNS timings can not be calculated,not
mitmproxy/examples/complex/har_dump.py,76,for lack of a way to measure it. The same goes for HAR blocked.,not
mitmproxy/examples/complex/har_dump.py,77,mitmproxy will open a server connection as soon as it receives the host,not
mitmproxy/examples/complex/har_dump.py,78,"and port from the client connection. So, the time spent waiting is actually",not
mitmproxy/examples/complex/har_dump.py,79,spent waiting between request.timestamp_end and response.timestamp_start,not
mitmproxy/examples/complex/har_dump.py,80,thus it correlates to HAR wait instead.,not
mitmproxy/examples/complex/har_dump.py,89,"HAR timings are integers in ms, so we re-encode the raw timings to that format.",not
mitmproxy/examples/complex/har_dump.py,95,full_time is the sum of all timings.,not
mitmproxy/examples/complex/har_dump.py,96,Timings set to -1 will be ignored as per spec.,not
mitmproxy/examples/complex/har_dump.py,101,Response body size and encoding,not
mitmproxy/examples/complex/har_dump.py,138,Store binary data as base64,not
mitmproxy/examples/complex/har_dump.py,191,HAR only needs some attributes,not
mitmproxy/examples/complex/har_dump.py,196,These keys need to be boolean!,not
mitmproxy/examples/complex/har_dump.py,200,Expiration time needs to be formatted,not
mitmproxy/examples/complex/xss_scanner.py,50,The actual payload is put between a frontWall and a backWall to make it easy,not
mitmproxy/examples/complex/xss_scanner.py,51,to locate the payload with regular expressions,not
mitmproxy/examples/complex/xss_scanner.py,57,A XSSData is a named tuple with the following fields:,not
mitmproxy/examples/complex/xss_scanner.py,58,- url -> str,not
mitmproxy/examples/complex/xss_scanner.py,59,- injection_point -> str,not
mitmproxy/examples/complex/xss_scanner.py,60,- exploit -> str,not
mitmproxy/examples/complex/xss_scanner.py,61,- line -> str,not
mitmproxy/examples/complex/xss_scanner.py,67,A SQLiData is named tuple with the following fields:,not
mitmproxy/examples/complex/xss_scanner.py,68,- url -> str,not
mitmproxy/examples/complex/xss_scanner.py,69,- injection_point -> str,not
mitmproxy/examples/complex/xss_scanner.py,70,- regex -> str,not
mitmproxy/examples/complex/xss_scanner.py,71,- dbms -> str,not
mitmproxy/examples/complex/xss_scanner.py,122,ensure the path ends in a /,not
mitmproxy/examples/complex/xss_scanner.py,124,the path must be a string while the payload is bytes,not
mitmproxy/examples/complex/xss_scanner.py,155,queries is a list of parameters where each parameter is set to the payload,not
mitmproxy/examples/complex/xss_scanner.py,167,"If it is None, then there is no info to log",not
mitmproxy/examples/complex/xss_scanner.py,192,Regexes taken from Damn Small SQLi Scanner: https://github.com/stamparm/DSSS/blob/master/dsss.py#L17,not
mitmproxy/examples/complex/xss_scanner.py,207,type: ignore,not
mitmproxy/examples/complex/xss_scanner.py,216,"A qc is either ' or """,not
mitmproxy/examples/complex/xss_scanner.py,225,Whether the next chunk of len(substring) chars is the substring,not
mitmproxy/examples/complex/xss_scanner.py,230,Whether this char is escaped with a \,not
mitmproxy/examples/complex/xss_scanner.py,290,"if there is a < then lxml will interpret that as a tag, so only search for the stuff before it",not
mitmproxy/examples/complex/xss_scanner.py,312,Only convert the body to bytes if needed,not
mitmproxy/examples/complex/xss_scanner.py,315,Regex for between 24 and 72 (aka 24*3) characters encapsulated by the walls,not
mitmproxy/examples/complex/xss_scanner.py,319,Where the string is injected into the HTML,not
mitmproxy/examples/complex/xss_scanner.py,325,Whether you can inject:,not
mitmproxy/examples/complex/xss_scanner.py,326,open angle brackets,not
mitmproxy/examples/complex/xss_scanner.py,327,close angle brackets,not
mitmproxy/examples/complex/xss_scanner.py,328,single quotes,not
mitmproxy/examples/complex/xss_scanner.py,329,double quotes,not
mitmproxy/examples/complex/xss_scanner.py,330,forward slashes,not
mitmproxy/examples/complex/xss_scanner.py,331,semicolons,not
mitmproxy/examples/complex/xss_scanner.py,332,equals sign,not
mitmproxy/examples/complex/xss_scanner.py,333,e.g. <script>PAYLOAD</script>,not
mitmproxy/examples/complex/xss_scanner.py,338,e.g. <script>t='PAYLOAD';</script>,not
mitmproxy/examples/complex/xss_scanner.py,343,"e.g. <script>t=""PAYLOAD"";</script>",not
mitmproxy/examples/complex/xss_scanner.py,349,e.g. <a href='PAYLOAD'>Test</a>,not
mitmproxy/examples/complex/xss_scanner.py,355,"e.g. <a href=""PAYLOAD"">Test</a>",not
mitmproxy/examples/complex/xss_scanner.py,361,e.g. <a href=PAYLOAD>Test</a>,not
mitmproxy/examples/complex/xss_scanner.py,366,e.g. <html><a href=PAYLOAD>Test</a>,not
mitmproxy/examples/complex/xss_scanner.py,371,"e.g. <a href=""PAYLOAD"">Test</a>",not
mitmproxy/examples/complex/xss_scanner.py,376,e.g. <a href='PAYLOAD'>Test</a>,not
mitmproxy/examples/complex/xss_scanner.py,381,e.g. <a href=PAYLOAD>Test</a>,not
mitmproxy/examples/complex/xss_scanner.py,386,e.g. <html>PAYLOAD</html>,not
mitmproxy/examples/complex/xss_scanner.py,396,response is mitmproxy's entry point,not
mitmproxy/examples/complex/xss_scanner.py,402,Example: http://xss.guru/unclaimedScriptTag.html,not
mitmproxy/examples/complex/xss_scanner.py,407,Example: https://daviddworken.com/vulnerableReferer.php,not
mitmproxy/examples/complex/xss_scanner.py,411,Example: https://daviddworken.com/vulnerableUA.php,not
mitmproxy/examples/complex/xss_scanner.py,416,Example: https://daviddworken.com/vulnerable.php?name=,not
mitmproxy/examples/complex/tls_passthrough.py,46,A server_address -> interception results mapping,not
mitmproxy/examples/complex/tls_passthrough.py,110,inline script hooks below.,not
mitmproxy/examples/complex/tls_passthrough.py,138,We try to intercept.,not
mitmproxy/examples/complex/tls_passthrough.py,139,Monkey-Patch the layer to get feedback from the TLSLayer if interception worked.,not
mitmproxy/examples/complex/tls_passthrough.py,142,"We don't intercept - reply with a pass-through layer and add a ""skipped"" entry.",not
mitmproxy/examples/complex/dup_and_replay.py,5,Avoid an infinite loop by not replaying already replayed requests,not
mitmproxy/examples/complex/dup_and_replay.py,9,"Only interactive tools have a view. If we have one, add a duplicate entry",not
mitmproxy/examples/complex/dup_and_replay.py,10,for our flow.,not
mitmproxy/examples/complex/nonblocking.py,6,Remove this and see what happens,not
mitmproxy/examples/complex/nonblocking.py,8,"This is ugly in mitmproxy's UI, but you don't want to use mitmproxy.ctx.log from a different thread.",SATD
mitmproxy/examples/complex/dns_spoofing.py,28,This regex extracts splits the host header into host and port.,not
mitmproxy/examples/complex/dns_spoofing.py,29,Handles the edge case of IPv6 addresses containing colons.,not
mitmproxy/examples/complex/dns_spoofing.py,30,https://bugzilla.mozilla.org/show_bug.cgi?id=45891,not
mitmproxy/examples/complex/block_dns_over_https.py,11,known DoH providers' hostnames and IP addresses to block,not
mitmproxy/examples/complex/block_dns_over_https.py,76,additional hostnames to block,not
mitmproxy/examples/complex/block_dns_over_https.py,81,additional IPs to block,not
mitmproxy/examples/complex/block_dns_over_https.py,88,convert to sets for faster lookups,not
mitmproxy/examples/complex/block_dns_over_https.py,130,Header 'Accept: application/dns-json' is required in Cloudflare's DoH JSON API,not
mitmproxy/examples/complex/block_dns_over_https.py,131,or they return a 400 HTTP response code,not
mitmproxy/examples/complex/block_dns_over_https.py,135,Google's DoH JSON API is https://dns.google/resolve,not
mitmproxy/examples/complex/block_dns_over_https.py,151,used in example in RFC 8484 (see https://tools.ietf.org/html/rfc8484#section-4.1.1),not
mitmproxy/examples/complex/mitmproxywrapper.py,1,!/usr/bin/env python,not
mitmproxy/examples/complex/mitmproxywrapper.py,2,,not
mitmproxy/examples/complex/mitmproxywrapper.py,3,Helper tool to enable/disable OS X proxy and wrap mitmproxy,not
mitmproxy/examples/complex/mitmproxywrapper.py,4,,not
mitmproxy/examples/complex/mitmproxywrapper.py,5,Get usage information with:,not
mitmproxy/examples/complex/mitmproxywrapper.py,6,,not
mitmproxy/examples/complex/mitmproxywrapper.py,7,mitmproxywrapper.py -h,not
mitmproxy/examples/complex/mitmproxywrapper.py,8,,not
mitmproxy/examples/complex/mitmproxywrapper.py,144,"parser.add_argument('--honeyproxy', action='store_true', help='run honeyproxy instead of mitmproxy')",not
mitmproxy/examples/complex/mitmproxywrapper.py,157,elif args.honeyproxy:,not
mitmproxy/examples/complex/mitmproxywrapper.py,158,wrapper.wrap_honeyproxy(),not
mitmproxy/examples/complex/sslstrip.py,7,noqa,not
mitmproxy/examples/complex/sslstrip.py,11,set of SSL/TLS capable hosts,not
mitmproxy/examples/complex/sslstrip.py,19,do not force https redirection,not
mitmproxy/examples/complex/sslstrip.py,22,proxy connections to SSL-enabled hosts,not
mitmproxy/examples/complex/sslstrip.py,27,We need to update the request destination to whatever is specified in the host header:,not
mitmproxy/examples/complex/sslstrip.py,28,Having no TLS Server Name Indication from the client and just an IP address as request.host,not
mitmproxy/examples/complex/sslstrip.py,29,"in transparent mode, TLS server name certificate validation would fail.",not
mitmproxy/examples/complex/sslstrip.py,38,strip links in response body,not
mitmproxy/examples/complex/sslstrip.py,41,strip meta tag upgrade-insecure-requests in response body,not
mitmproxy/examples/complex/sslstrip.py,45,strip links in 'Location' header,not
mitmproxy/examples/complex/sslstrip.py,53,strip upgrade-insecure-requests in Content-Security-Policy header,not
mitmproxy/examples/complex/sslstrip.py,60,strip secure flag from 'Set-Cookie' headers,not
mitmproxy/examples/complex/webscanner_helper/watchdog.py,66,save the request which might have caused the problem,not
mitmproxy/examples/complex/webscanner_helper/urldict.py,80,cast necessary for mypy,not
mitmproxy/examples/complex/webscanner_helper/mapping.py,131,make sure that all items are strings and not soups.,not
mitmproxy/docs/render_examples.py,1,!/usr/bin/env python3,not
mitmproxy/docs/scripts/filters.py,1,!/usr/bin/env python3,not
mitmproxy/docs/scripts/options.py,1,!/usr/bin/env python3,not
